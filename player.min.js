function play_powerup(){document.getElementById("audiotag1").play()}function play_powerdown(){document.getElementById("audiotag2").play()}function play_damage(){document.getElementById("audiotag3").play()}function play_death(){document.getElementById("audiotag4").play()}function play_med(){document.getElementById("audiotag5").play()}function play_slurp(){document.getElementById("audiotag6").play()}function play_host_death(){document.getElementById("audiotag8").play()}function play_host_revival(){document.getElementById("audiotag9").play()}function play_cancer_spawn(){document.getElementById("audiotag10").play()}function play_click(){document.getElementById("audiotag11").play()}function play_cancer(){document.getElementById("audiotag7").volume=intensity<1?intensity:0,document.getElementById("audiotag7").play()}function stop_sounds(){document.getElementById("audiotag1").pause(),document.getElementById("audiotag2").pause(),document.getElementById("audiotag3").pause(),document.getElementById("audiotag4").pause(),document.getElementById("audiotag5").pause(),document.getElementById("audiotag6").pause(),document.getElementById("audiotag7").pause(),document.getElementById("audiotag10").pause()}stop_sounds();function tutor(){tutorsteps=[!1,!1,!1],signDiv.style.display="none",deathDiv.style.display="none",gameDiv.style.display="none",document.getElementById("tutorDiv").style.display="inline-block",wants=!0,incircle=0,setTimeout(play,10)}function play_tip(){disscore&&document.getElementById("audiotag12").play()}function hex_rv(e){if("#"==e.charAt(0)&&7==e.length){for(var t="#",l=1;l<7;l++){var i=parseInt(e.charAt(l),16);if(!(0<=i&&i<16))return"#000000";t+=(i=15-i).toString(16).toUpperCase()}return t}return"#000000"}getDistance=function(e,t,l,i){return Math.sqrt(Math.pow(e-l,2)+Math.pow(t-i,2))},gettime=function(){return d=new Date,d.getTime()};var WIDTH=window.innerWidth,HEIGHT=window.innerHeight;const cell_immune=[0,20,40,80,1e9,1e9];document.getElementById("ctx").width=WIDTH,document.getElementById("ctx").height=HEIGHT;var mini=document.getElementById("minimap").getContext("2d"),socket=null,entermed=0,exitmed=0,stage=4,tutorsteps=[!1,!1,!1],startti=0,wants=!1,endti=0,sizeX=5e3,numcells=0,sizeY=5e3,finalscore=0,ino=!0,numvirus=0,numplayers=0,iradtimer=0,x=0,y=0,intensity=0,mousex=0,mousey=0,selfx=0,selfy=0,lastx=0,lasty=0,reset=!1,playing=!1,medicine=[],scores=[],names=[],resettimer=100,numcancer=0,cancerwaslast=!0,alerts=["Enter!","",""],tooltips=["Press enter â†µ to cycle through display tips","",""],ontip=0;const viewtips=["This is how many viruses you have","This is how many cancer cells there are","This is how many red cells you have infected","This is your resistance to green medicine","This is your resistance to blue medicine","This is your resistance to purple medicine","This is your score",""];getleader(),void 0!==Cookies.get("topscore")&&Cookies.get("topscore")>0&&(document.getElementById("welcome").style.display="inline-block",document.getElementById("cookiescore").innerHTML=Number(Cookies.get("topscore")).toLocaleString());var signDiv=document.getElementById("signDiv"),deathDiv=document.getElementById("deathDiv"),signDivUsername=document.getElementById("signDiv-username"),handle=Cookies.get("name");void 0===handle&&(handle=""),signDivUsername.value=handle;var signDivSignIn=document.getElementById("signDiv-signIn");getDistance=function(e,t,l,i){return Math.sqrt(Math.pow(e-l,2)+Math.pow(t-i,2))};function addtooltip(e){a3[e]||(a3[e]=!0,alerts.unshift(a1[e]),tooltips.unshift(a2[e]),play_tip())}signDivSignIn.onclick=function(){playp()},playp=function(){disscore=!1,ontip=7,play()},play=function(){Cookies.set("name",signDivUsername.value+"");var e=document.getElementById("serverSelect"),t=e.options[e.selectedIndex].value;alert(t),socket=io.connect(t),document.getElementById("tutorDiv").display="none",socket.emit("signIn",{username:signDivUsername.value}),playing=!0,socket.on("medicine",function(e){medicine=e}),socket.on("signInResponse",function(e){e.success?(signDiv.style.display="none",deathDiv.style.display="none",gameDiv.style.display="inline-block",document.getElementById("tutorDiv").style.display="none",wants?(ino=!1,selfx=500,selfy=500):ino=!0,main()):alert("This server is full, you have been autoredirected to spectator mode")}),socket.on("scores",function(e){scorelist=e}),socket.on("co",function(e){e&&addtooltip(15)}),socket.on("evalAnswer",function(e){}),socket.on("resetall",function(e){reset=!0}),socket.on("stage",function(e){stage=e,counter>20&&(1===stage?play_powerup():2===stage?play_damage():3===stage&&play_powerdown())}),socket.on("death",function(e){deathDiv.style.display="inline-block",gameDiv.style.display="inline-block",finalscore=Math.round(Player.list[selfId].infects*(100*(1-Player.list[selfId].dmg[0])*(100*(1-Player.list[selfId].dmg[1])))*(100*(1-Player.list[selfId].dmg[2]))),stop_sounds(),document.getElementById("scored").innerHTML="Final score: "+finalscore;var t=Cookies.get("topscore");isNaN(t)||t<finalscore?(Cookies.set("topscore",finalscore),document.getElementById("best").style.display="inline-block"):document.getElementById("best").style.display="none"}),socket.on("init",function(e){e.selfId&&(selfId=e.selfId);for(var t=0;t<e.player.length;t++)new Player(e.player[t]);for(t=0;t<e.cell.length;t++)new Cell(e.cell[t])}),socket.on("remove",function(e){for(var t=0;t<e.player.length;t++)delete Player.list[e.player[t]];for(t=0;t<e.cell.length;t++)cell=Cell.list[e.cell[t]],void 0!==cell?cell.type?cell.phase=!0:cell.prephase=!0:delete Cell.list[self.id]}),socket.on("update",function(e){for(var t=0;t<e.player.length;t++){var l=e.player[t],i=Player.list[l.id];i&&(void 0!==l.x&&(i.x=l.x),void 0!==l.y&&(i.y=l.y),void 0!==l.hp&&(i.hp=l.hp),void 0!==l.immunity&&(i.dmg=l.immunity),void 0!==l.infects&&(l.infects!==i.infects&&i.id===selfId&&(counterp=counter+50),i.infects=l.infects),void 0!==l.avg&&(i.avg=l.avg),void 0!==l.color&&(i.color=l.color),void 0!==l.name&&(i.name=l.name))}for(t=0;t<e.cell.length;t++){l=e.cell[t];var s=Cell.list[e.cell[t].id];s&&(void 0!==l.x&&(s.x=l.x),void 0!==l.y&&(s.y=l.y),void 0!==l.create&&(s.create=l.create),void 0!==l.cells&&(s.cells=l.cells),void 0!==l.size&&(s.size=l.size))}}),document.onkeydown=function(e){68===e.keyCode?socket.emit("evalServer","placeRadiation()"):86===e.keyCode?socket.emit("evalServer","Player.list["+selfId+"].createnew("+selfx+","+selfy+");"):84===e.keyCode?(disscore=!disscore)||(ontip=7):32===e.keyCode?(tutorsteps[0]=!0,selfx=Player.list[selfId].x[0],selfy=Player.list[selfId].y[0]):13===e.keyCode?(addtooltip(1),play_click(),8===++ontip&&(ontip=0)):82===e.keyCode?socket.emit("evalServer","rad()"):77===e.keyCode?socket.emit("evalServer","placeMedicine("+selfx+","+selfy+",0);"):87===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",4,false,25)"):49===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",1,true)"):50===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",2,true)"):51===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",3,true)"):52===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",4,true)"):84===e.keyCode?socket.emit("evalServer","delay"):67===e.keyCode&&socket.emit("evalServer","createCancerCell("+selfx+","+selfy+",1)")}};var scorelist=[],radstop=0;drawminimap=function(){mini.save(),mini.clearRect(0,0,150,150),mini.restore()};var ctx=document.getElementById("ctx").getContext("2d");ctx.font="30px Arial";var Player=function(e){var t={};return t.id=e.id,t.x=e.x,t.y=e.y,t.hp=e.hp,t.hpMax=e.hpMax,t.dmg=e.immunity,t.avg=e.avg,t.color=String(e.color),t.infects=0,t.introuble=!1,t.name=e.name,t.draw=function(){if(t.id){ino&&(selfx=Player.list[selfId].x[0],selfy=Player.list[selfId].y[0],ino=!1);var e=t.x[0]-selfx+WIDTH/2,l=t.y[0]-selfy+HEIGHT/2;if(ctx.beginPath(),ctx.fillStyle=t.color,t.id===selfId){wants&&(incircle<t.x.length?0===t.infects&&(ctx.globalAlpha=1,ctx.font="bold 40px Arial",ctx.fillStyle="black",ctx.fillText("These are your viruses",e-200,l-50)):ctx.globalAlpha=0,ctx.globalAlpha=1);e=mousex,l=mousey;ctx.beginPath(),ctx.arc(e,l,500,0,2*Math.PI)}ctx.stroke();for(var i in t.x){numvirus++,ctx.fillStyle=t.color,mini.fillStyle=t.color,mini.fillRect(t.x[i]/sizeX*150-2,t.y[i]/sizeY*150-2,4,4);e=t.x[i]-selfx+WIDTH/2,l=t.y[i]-selfy+HEIGHT/2;void 0!==medicine[0]&&getDistance(t.x[i],t.y[i],medicine[0],medicine[1])<medicine[2]&&Player.list[selfId].dmg[medicine[4]]>.001?t.introuble=!0:t.introuble=!1,t.introuble?t.id===selfId?(drawFlu(e,l,8,timer,hex_rv(t.color)),inmed++,play_med()):drawFlu(e,l,8,timer,t.color):(drawFlu(e,l,8,timer,1===stage&&counter%16<8?hex_rv(t.color):t.color),document.getElementById("audiotag5").pause()),ctx.fillStyle="black"}}},Player.list[t.id]=t,t};Player.list={},drawMed=function(){if(void 0!==medicine[1]){ctx.beginPath(),mini.beginPath(),0===medicine[4]?(addtooltip(2),ctx.fillStyle="#39FF14",mini.fillStyle="#39FF14"):1===medicine[4]?(addtooltip(3),ctx.fillStyle="#00CCFF",mini.fillStyle="#00CCFF"):2===medicine[4]&&(addtooltip(4),ctx.fillStyle="#FF1DCE",mini.fillStyle="#FF1DCE");var e=medicine[0]-selfx+WIDTH/2,t=medicine[1]-selfy+HEIGHT/2;ctx.globalAlpha=medicine[3],mini.globalAlpha=medicine[3],ctx.arc(e,t,medicine[2],0,2*Math.PI),mini.arc(medicine[0]/sizeX*150,medicine[1]/sizeY*150,medicine[2]/sizeX*150,0,2*Math.PI),ctx.fill(),mini.fill(),ctx.globalAlpha=1,mini.globalAlpha=1,mini.fillStyle="black"}};var Cell=function(e){var t={};return t.id=e.id,t.x=e.x,t.y=e.y,t.size=e.size,t.create=e.create,t.type=e.type,t.cells=e.cells,t.cancer=e.cancer,t.eat=null,t.mag=null,t.phase=!1,t.phaser=1,t.prephase=!1,t.prephaser=2,t.lastcells=0,t.draw=function(){var e=t.cells;numcells++,t.lastcells!==t.cells&&(t.lastcells=t.cells,t.type||play_slurp()),t.prephase&&(t.prephaser-=.1,t.type||(t.size=20*t.cells+25),t.prephaser<.1&&(t.phase=!0)),t.cancer&&numcancer++;var l=t.x-selfx+WIDTH/2,i=t.y-selfy+HEIGHT/2;if(t.type){if(t.phase&&(t.phaser-=.1,t.phaser<=.1))return void delete Cell.list[t.id];if(ctx.globalAlpha=t.phaser,t.cells>0&&1===stage&&counter%16<8){for(ctx.fillStyle="#ffc0cb",t.cancer?drawCell(l,i,t.size,"#00134C","#3366ff"):drawCell(l,i,t.size,"#003F34","#009982");t.cells>0;)drawFlu(l+t.size/2-50*t.cells+25,i+t.size/2-50*t.cells+25,10,timer,"green",0),t.cells-=1;t.cells=e}else{for(ctx.fillStyle="#003f34",t.cancer?(drawCell(l,i,t.size,"#FFECB3","#CC9900"),play_cancer()):Player.list[selfId].avg<(cell_immune[Math.round(t.size/50)]||t.size/50>=4)||t.cells>0?drawCell(l,i,t.size,"pink","#FF667D"):(50===t.size?addtooltip(5):addtooltip(14),drawCell(l,i,t.size,"black","#FF667D"),ctx.beginPath(),ctx.arc(l,i,t.size,0,2*Math.PI),ctx.stroke(),ctx.lineWidth=2);t.cells>0;)drawFlu(l+t.size/2-50*t.cells+25,i+t.size/2-50*t.cells+25,10,timer,"green",0),t.cells-=1;t.cells=e}}else{if(t.phase&&(t.phaser-=.1,t.phaser<=.1))return void delete Cell.list[t.id];for(ctx.globalAlpha=t.phaser,drawCell(l,i,.8*t.size,"gray","white");t.cells>0;)drawFlu(l+t.size/2-24*t.cells+5,i+t.size/2-24*t.cells+5,10,timer,"green",0),t.cells-=1;t.cells=e}ctx.globalAlpha=1},Cell.list[t.id]=t,t};Cell.list={};var selfId=null,counterp=1e8;function updatexy(){if(getDistance(WIDTH/2+8,HEIGHT/2+8,mousex,mousey)<10)socket.emit("keyPress",{inputId:"mouseX",state:[selfx,selfy]});else{var e=mousex+selfx-WIDTH/2,t=mousey+selfy-HEIGHT/2;socket.emit("keyPress",{inputId:"mouseX",state:[e,t]})}}var timer=0,pulser=0,counter=0,down=!1;function updatePulser(){pulser>5?down=!0:pulser<-5&&(pulser+=.5,down=!1),down?pulser-=.5:pulser+=.5}main=function(){if(startti=gettime(),mini.clearRect(0,0,150,150),drawminimap(),counter===counterp&&play_death(),ctx.clearRect(0,0,WIDTH,HEIGHT),inmed=0,selfId){updatePulser(),void 0!=Player.list[selfId]&&(selfy=(mousey-HEIGHT/2)/20+selfy,(selfx=(mousex-WIDTH/2)/20+selfx)<WIDTH/2&&(selfx=WIDTH/2),selfy<HEIGHT/2&&(selfy=HEIGHT/2),selfx>sizeX-WIDTH/2&&(selfx=sizeX-WIDTH/2),selfy>sizeY-HEIGHT/2&&(selfy=sizeY-HEIGHT/2)),ctx.fillStyle="white",ctx.fillRect(x,y,sizeX,sizeY),ctx.globalAlpha=intensity,ctx.fillStyle="black",ctx.fillRect(0,0,WIDTH,HEIGHT),ctx.globalAlpha=1,drawMap(),drawMed(),updatexy(),incircle=0;for(var e=0;e<Player.list[selfId].x.length;e++)getDistance(selfx+(mousex-WIDTH/2),selfy+(mousey-HEIGHT/2),Player.list[selfId].x[e],Player.list[selfId].y[e])<500?incircle++:wants&&(ctx.globalAlpha=.4,ctx.fillStyle=hex_rv(Player.list[selfId].color),ctx.beginPath(),ctx.arc(Player.list[selfId].x[e]-selfx+WIDTH/2,Player.list[selfId].y[e]-selfy+HEIGHT/2,40,0,2*Math.PI),ctx.stroke(),ctx.fill());ctx.globalAlpha=1;for(var e in Player.list)Player.list[e].draw();for(var e in Cell.list)Cell.list[e].draw();if(Player.list[selfId]&&drawScoreboard(),reset&&(document.getElementById("audiotag8").pause(),play_host_revival(),ctx.fillStyle="white",ctx.globalAlpha=resettimer/100,ctx.fillRect(0,0,WIDTH,HEIGHT),ctx.fillStyle="black",ctx.font="160px ubuntu",ctx.fillText("REVIVED!",WIDTH/2-300,HEIGHT/2-20),resettimer-=1.5,ctx.globalAlpha=1,resettimer<=0&&(reset=!1,resettimer=100)),ctx.beginPath(),ctx.arc(mousex,mousey,500,0,2*Math.PI),ctx.stroke(),wants){incircle=0,ctx.font="bold 40px Arial",ctx.fillStyle="black",wants&&!tutorsteps[0]&&ctx.fillText("Press SPACE to find your viruses",mousex-300,mousey-50);for(e=0;e<Player.list[selfId].x.length;e++)getDistance(selfx+(mousex-WIDTH/2),selfy+(mousey-HEIGHT/2),Player.list[selfId].x[e],Player.list[selfId].y[e])<500&&incircle++;incircle<Player.list[selfId].x.length&&tutorsteps[0]?ctx.fillText("Keep your viruses inside your mouse circle",mousex-400,mousey-50):!0===tutorsteps[0]&&inmed>0?(ctx.fillText("Escape the medicine before it kills you!",mousex-300,mousey-50),0===entermed&&(entermed=counter,exitmed=0)):!0===tutorsteps[0]&&0===inmed&&(entermed>0||exitmed>0)?(0===exitmed&&(exitmed=counter+90,entermed=0),counter<exitmed&&ctx.fillText("What doesn't kill you makes you stronger!",mousex-400,mousey-50)):!0===tutorsteps[0]&&0===Player.list[selfId].infects?ctx.fillText("Attack a small red cell until it fills up",mousex-350,mousey-50):!0===tutorsteps[0]&&Player.list[selfId].infects>0&&counter<300&&ctx.fillText("Congratulations! You replicated your virus.",mousex-400,mousey-50)}intensity=numcancer/(numvirus+1),intensity=Math.pow(intensity,2),timer++,counter++,numcancer=0,numcells=0,numvirus=0,endti=gettime(),delay=40-(endti-startti)<=0?0:1e3/30-(endti-startti),setTimeout(main,delay)}};function drawGrid(e,t,l,i,s,o,n,a){ctx.save(),ctx.globalAlpha=.5,ctx.translate(e,t),ctx.beginPath(),ctx.strokeColor=o,ctx.lineWidth=2;for(var c=0;c<l||c<i;c+=s)ctx.moveTo(0,c),ctx.lineTo(l,c),ctx.moveTo(c+n%s,0),ctx.lineTo(c+n%s,i);ctx.strokeStyle=o,ctx.stroke(),ctx.closePath(),ctx.restore()}var drawMap=function(){var e=WIDTH/2-selfx,t=HEIGHT/2-selfy;counter<radstop||4===stage?(ctx.fillStyle="white",drawGrid(e,t,sizeX,sizeY,50,"#BFBFBF",0,0)):1===stage?(ctx.fillStyle="#070707",addtooltip(6),ctx.fillRect(e,t,sizeX,sizeY),drawGrid(e,t,sizeX,sizeY,50,"#404040",0,0)):(ctx.fillStyle="white",drawGrid(e,t,sizeX,sizeY,50,"#BFBFBF",0,0))},drawScore=function(){ctx.fillStyle="white"};drawBox=function(e,t,l,i){ctx.fillStyle="#FFFF00",ctx.globalAlpha=.5,ctx.beginPath(),ctx.arc(e,t,i,.5*Math.PI,-.5*Math.PI),ctx.lineTo(e+l,t-i),ctx.arc(e+l,t,i,-.5*Math.PI,.5*Math.PI),ctx.lineTo(e,t+i),ctx.stroke(),ctx.fill(),ctx.globalAlpha=1};var widthsofboxes=[690,750,850,500,500,500,400,0],heightsofboxes=[50,50,50,20,20,20,50,0],drawScoreboard=function(){if(Player.list[selfId].dmg[0]<.99&&addtooltip(11),Player.list[selfId].dmg[1]<.99&&addtooltip(12),Player.list[selfId].dmg[2]<.99&&addtooltip(13),ontip<3||6===ontip){ctx.font="40px ubuntu";var e=30}else{ctx.font="20px ubuntu";e=15}for(var t=0;t<ontip;t++)e+=heightsofboxes[t];7!==ontip&&drawBox(0,e,widthsofboxes[ontip]+50,heightsofboxes[ontip]/2),ctx.fillStyle="black",ontip<3||ontip>=6?7!==ontip?ctx.fillText(viewtips[ontip]+" â†µ",150,e+10):ctx.fillText("",150,e+10):ctx.fillText(viewtips[ontip]+" ("+Math.round(100*(1-Player.list[selfId].dmg[ontip-3]))+"%) â†µ",150,e+5);var l="<table style = 'font-size:30px;'>";for(t=0;t<3;t++)l+="<tr><td><b>"+alerts[t]+"</b></td><td>"+tooltips[t]+"</td><td></tr>";l+="</table>",document.getElementById("vvv").innerHTML=disscore?l:"";var i="<table id = 'leadertable' style = 'font-size:23.5px;'><caption>Scoreboard</caption>",s=0;for(t=0;t<scorelist.length;t++){var o=scorelist[t];if(void 0!==Player.list[o]){var n=Math.round(Player.list[o].infects*(100*(1-Player.list[o].dmg[0])*(100*(1-Player.list[o].dmg[1])))*(100*(1-Player.list[o].dmg[2])));n>1e3&&n<1e6?n=Math.floor(n/1e3)+"K":n>1e6&&(n=Math.floor(n/1e6)+"M"),i+="<tr><td>"+(t+1)+".</td><td style = 'overflow:hidden;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+Player.list[o].name.substr(0,6)+"</td><td>"+n+"</td><td></tr>",drawFlu(WIDTH-215,30*s+70,8,0,Player.list[o].color),s++}}i+="</table>",document.getElementById("scoreboard").innerHTML=i,ctx.fillStyle="black",ctx.globalAlpha=.5,ctx.fillStyle="black",ctx.globalAlpha=1,drawFlu(20,30,10,timer,Player.list[selfId].color),drawCell(20,130,14,"pink","#FF667D"),drawCell(20,80,14,"#FFECB3","#CC9900"),ctx.font="40px ubuntu",ctx.fillText(Math.round(Player.list[selfId].infects),40,140),1===Math.round(Player.list[selfId].infects)&&addtooltip(9),ctx.fillText(Math.round(Player.list[selfId].infects*(100*(1-Player.list[selfId].dmg[0])*(100*(1-Player.list[selfId].dmg[1])))*(100*(1-Player.list[selfId].dmg[2]))),0,250),ctx.font="30px ubuntu",ctx.font="40px ubuntu",0!==numcancer&&cancerwaslast&&(play_cancer_spawn(),cancerwaslast=!1),cancerwaslast||0!==numcancer?0===numcancer&&(cancerwaslast=!0):addtooltip(10),numcancer>0&&addtooltip(7);var a=Player.list[selfId].x;ctx.fillText(a.length,40,40),ctx.fillText(numcancer,40,90),ctx.strokeStyle="#39FF14",ctx.strokeRect(0,155,100,20),ctx.strokeStyle="#00CCFF",ctx.strokeRect(0,175,100,20),ctx.strokeStyle="#FF1DCE",ctx.strokeRect(0,195,100,20),ctx.globalAlpha=.5,ctx.fillStyle="#39FF14",ctx.fillRect(0,155,100*(1-Player.list[selfId].dmg[0]),20),ctx.fillStyle="#00CCFF",ctx.fillRect(0,175,100*(1-Player.list[selfId].dmg[1]),20),ctx.fillStyle="#FF1DCE",ctx.fillRect(0,195,100*(1-Player.list[selfId].dmg[2]),20),ctx.globalAlpha=1,ctx.strokeStyle="black",ctx.fillStyle="gray",intensity>.5&&(addtooltip(8),intensity>1&&(document.getElementById("audiotag7").pause(),play_host_death()))};drawCell=function(e,t,l,i,s,o,n){if(ctx.save(),ctx.strokeStyle=i,ctx.lineWidth=l/10,ctx.fillStyle=s,ctx.translate(e,t),ctx.fillStyle=i,ctx.beginPath(),ctx.arc(0,0,l,0,2*Math.PI),ctx.fill(),ctx.fillStyle=s,ctx.beginPath(),ctx.arc(0,0,l*(.9+pulser/200),0,2*Math.PI),ctx.fill(),void 0!==o){var a=Math.cos(o/180*Math.PI)*l,c=Math.sin(o/180*Math.PI)*l;ctx.fillStyle="#ffc0cb",ctx.beginPath(),ctx.arc(.95*a,.95*c,l*(.1*n),0,2*Math.PI),ctx.fill(),ctx.fillStyle="white",ctx.beginPath(),ctx.arc(a,c,l*(.1*n),0,2*Math.PI),ctx.fill()}ctx.restore()};function drawFlu(e,t,l,i,s,o){var n=0;n=void 0!==o?o:.5,ctx.save(),ctx.translate(e,t),ctx.lineWidth=3,ctx.rotate(i*(Math.PI/180)),ctx.lineCap="round",ctx.beginPath(),ctx.arc(0,0,l,0,2*Math.PI),ctx.stroke(),ctx.moveTo(0,-1*l),ctx.lineTo(0,1.5*l*-1),ctx.stroke(),ctx.moveTo(0,1*l),ctx.lineTo(0,1.5*l*1),ctx.stroke(),ctx.moveTo(-1*l,0),ctx.lineTo(1.5*l*-1,0),ctx.stroke(),ctx.moveTo(1*l,0),ctx.lineTo(1.5*l*1,0),ctx.stroke(),ctx.rotate(Math.PI/180*45),ctx.moveTo(0,-1*l),ctx.lineTo(0,1.5*l*-1),ctx.stroke(),ctx.moveTo(0,1*l),ctx.lineTo(0,1.5*l*1),ctx.stroke(),ctx.moveTo(-1*l,0),ctx.lineTo(1.5*l*-1,0),ctx.stroke(),ctx.moveTo(1*l,0),ctx.lineTo(1.5*l*1,0),ctx.stroke(),ctx.fillStyle=s,ctx.globalAlpha=n,ctx.fill(),ctx.restore()}function drawLis(e,t,l,i,s){ctx.save(),ctx.translate(e,t),ctx.lineWidth=3,ctx.rotate(i*(Math.PI/180)),ctx.lineCap="round",ctx.beginPath(),ctx.arc(0,0,l,0,1*Math.PI),ctx.lineTo(-1*l,-2*l),ctx.arc(0,-2*l,l,1*Math.PI,2*Math.PI),ctx.lineTo(l,0),ctx.stroke(),ctx.moveTo(0,-3*l),ctx.lineTo(0,3.5*l*-1),ctx.stroke(),ctx.moveTo(0,1*l),ctx.lineTo(0,1.5*l*1),ctx.stroke(),ctx.moveTo(-1*l,0),ctx.lineTo(1.5*l*-1,0),ctx.stroke(),ctx.moveTo(1*l,0),ctx.lineTo(1.5*l*1,0),ctx.stroke(),ctx.rotate(Math.PI/180*45),ctx.moveTo(0,1*l),ctx.lineTo(0,1.5*l*1),ctx.stroke(),ctx.moveTo(1*l,0),ctx.lineTo(1.5*l*1,0),ctx.stroke(),ctx.rotate(Math.PI/180*-45),ctx.moveTo(1*l,-1*l*1),ctx.lineTo(1.5*l*1,-1*l*1),ctx.stroke(),ctx.moveTo(-1*l,-1*l*1),ctx.lineTo(1.5*l*-1,-1*l*1),ctx.stroke(),ctx.moveTo(0,-3*l),ctx.lineTo(0,3.5*l*-1),ctx.stroke(),ctx.moveTo(-1*l,-2*l),ctx.lineTo(1.5*l*-1,-2*l),ctx.stroke(),ctx.moveTo(1*l,-2*l),ctx.lineTo(1.5*l*1,-2*l),ctx.stroke(),ctx.moveTo(-.75*l,-2.75*l),ctx.lineTo(-1.15*l,-3.15*l),ctx.stroke(),ctx.moveTo(.75*l,-2.75*l),ctx.lineTo(1.15*l,-3.15*l),ctx.stroke(),ctx.fillStyle=s,ctx.globalAlpha=.5,ctx.fill(),ctx.restore()}var disscore=!0;a1=["","Infect!","Caution!","Warning!","Danger!","Immune!","Wait!","Cancer!","Death!","Reproduce!","Survivor!","Green!","Blue!","Purple!","Mutate!","Mutate!"],a2=["","Use your mouse to guide your viruses to infect the red cells.<br>Smaller red cells are easier to infect.","Unhealthy green anti-viral medicine has spawned!<br>If your viruses survive, they develop green resistance.","Crippling blue anti-viral medicine has spawned!<br>If your viruses survive, they develop blue resistance.","Deadly purple anti-viral medicine has spawned!<br>If your viruses survive, they develop purple resistance.","Red cells with black membranes are now immune to your viruses.<br>Infect a red cell with another player to mutate.","Infected cells are being irradiated, killing the viruses trapped inside.<br>Wait until radiation ends before infecting.","Cancer cells have spawned!<br>Find and infect the brown cells to stop the host from dying.","The host is near death!<br>Destroy the brown cancer cells to stop the host from dying.","Your viruses have infected a red cell!<br>The cell will release your trapped viruses plus one new one.","You saved the host by defeating the cancer! ðŸŽ—","Exposure to green medicine has strengthened your viruses.<br>Your score has increased.","Exposure to blue medicine has strengthened your viruses.<br>Your score has increased.","Exposure to purple medicine has strengthened your viruses.<br>Your score has increased.","Many red cells are immune to your viruses.<br>Infect a red cell with another player to mutate.","Your viruses have exchanged genes! Fewer red cells are immune."],a3=[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],document.onmousemove=function(e){mousex=e.clientX,mousey=e.clientY},window.onresize=function(e){WIDTH=window.innerWidth,HEIGHT=window.innerHeight,document.getElementById("ctx").width=WIDTH,document.getElementById("ctx").height=HEIGHT};