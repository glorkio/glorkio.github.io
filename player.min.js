function play_powerup(){document.getElementById("audiotag1").play()}function play_powerdown(){document.getElementById("audiotag2").play()}function play_damage(){document.getElementById("audiotag3").play()}function play_death(){document.getElementById("audiotag4").play()}function play_med(){document.getElementById("audiotag5").play()}function play_slurp(){document.getElementById("audiotag6").play()}function play_host_death(){document.getElementById("audiotag8").play()}function play_host_revival(){document.getElementById("audiotag9").play()}function play_cancer_spawn(){document.getElementById("audiotag10").play()}function play_click(){document.getElementById("audiotag11").play()}function play_cancer(){document.getElementById("audiotag7").volume=intensity<1?intensity:0,document.getElementById("audiotag7").play()}function stop_sounds(){document.getElementById("audiotag1").pause(),document.getElementById("audiotag2").pause(),document.getElementById("audiotag3").pause(),document.getElementById("audiotag4").pause(),document.getElementById("audiotag5").pause(),document.getElementById("audiotag6").pause(),document.getElementById("audiotag7").pause(),document.getElementById("audiotag10").pause()}!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).io=e()}}(function(){return function e(t,n,r){function o(s,a){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var p=n[s]={exports:{}};t[s][0].call(p.exports,function(e){var n=t[s][1][e];return o(n||e)},p,p.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":3,"engine.io-parser":19}],3:[function(e,t,n){(function(n){var r=e("./transports"),o=e("component-emitter"),i=e("debug")("engine.io-client:socket"),s=e("indexof"),a=e("engine.io-parser"),c=e("parseuri"),l=e("parsejson"),p=e("parseqs");t.exports=u;function u(e,t){if(!(this instanceof u))return new u(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=c(e),t.hostname=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=c(t.host).host),this.secure=null!=t.secure?t.secure:n.location&&"https:"==location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=p.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized?null:t.rejectUnauthorized;var r="object"==typeof n&&n;r.global===r&&t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),this.open()}u.priorWebsocketSuccess=!1,o(u.prototype),u.protocol=a.protocol,u.Socket=u,u.Transport=e("./transport"),u.transports=e("./transports"),u.parser=e("engine.io-parser"),u.prototype.createTransport=function(e){i('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=a.protocol,t.transport=e,this.id&&(t.sid=this.id);return new r[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized,perMessageDeflate:this.perMessageDeflate,extraHeaders:this.extraHeaders})};u.prototype.open=function(){var e;if(this.rememberUpgrade&&u.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},u.prototype.setTransport=function(e){i("setting transport %s",e.name);var t=this;this.transport&&(i("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},u.prototype.probe=function(e){i('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;u.priorWebsocketSuccess=!1;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(i('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(o){if(!n)if("pong"==o.type&&"probe"==o.data){if(i('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;u.priorWebsocketSuccess="websocket"==t.name,i('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!=r.readyState&&(i("changing transport and sending upgrade packet"),f(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{i('probe transport "%s" failed',e);var s=new Error("probe error");s.transport=t.name,r.emit("upgradeError",s)}}))}function s(){n||(n=!0,f(),t.close(),t=null)}function a(n){var o=new Error("probe error: "+n);o.transport=t.name,s(),i('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function c(){a("transport closed")}function l(){a("socket closed")}function p(e){t&&e.name!=t.name&&(i('"%s" works - aborting "%s"',e.name,t.name),s())}function f(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",c),r.removeListener("close",l),r.removeListener("upgrading",p)}t.once("open",o),t.once("error",a),t.once("close",c),this.once("close",l),this.once("upgrading",p),t.open()},u.prototype.onOpen=function(){if(i("socket open"),this.readyState="open",u.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){i("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},u.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(i('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(l(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else i('packet received with socket readyState "%s"',this.readyState)},u.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},u.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},u.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){i("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},u.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},u.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},u.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(i("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},u.prototype.write=u.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},u.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!=this.readyState&&"closed"!=this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},u.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),i("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},u.prototype.onError=function(e){i("socket error %j",e),u.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},u.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){i('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},u.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./transport":4,"./transports":5,"component-emitter":15,debug:17,"engine.io-parser":19,indexof:23,parsejson:26,parseqs:27,parseuri:28}],4:[function(e,t,n){var r=e("engine.io-parser"),o=e("component-emitter");t.exports=i;function i(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders}o(i.prototype),i.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},i.prototype.open=function(){return"closed"!=this.readyState&&""!=this.readyState||(this.readyState="opening",this.doOpen()),this},i.prototype.close=function(){return"opening"!=this.readyState&&"open"!=this.readyState||(this.doClose(),this.onClose()),this},i.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},i.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},i.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},i.prototype.onPacket=function(e){this.emit("packet",e)},i.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":15,"engine.io-parser":19}],5:[function(e,t,n){(function(t){var r=e("xmlhttprequest-ssl"),o=e("./polling-xhr"),i=e("./polling-jsonp"),s=e("./websocket");n.polling=function(e){var n=!1,s=!1,a=!1!==e.jsonp;if(t.location){var c="https:"==location.protocol,l=location.port;l||(l=c?443:80),n=e.hostname!=location.hostname||l!=e.port,s=e.secure!=c}if(e.xdomain=n,e.xscheme=s,"open"in new r(e)&&!e.forceJSONP)return new o(e);if(!a)throw new Error("JSONP disabled");return new i(e)},n.websocket=s}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling-jsonp":6,"./polling-xhr":7,"./websocket":9,"xmlhttprequest-ssl":10}],6:[function(e,t,n){(function(n){var r=e("./polling"),o=e("component-inherit");t.exports=l;var i,s=/\n/g,a=/\\n/g;function c(){}function l(e){r.call(this,e),this.query=this.query||{},i||(n.___eio||(n.___eio=[]),i=n.___eio),this.index=i.length;var t=this;i.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=c)},!1)}o(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},l.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=c,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}this.form.action=this.uri();function l(){p(),t()}function p(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}p(),e=e.replace(a,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==n.iframe.readyState&&l()}:this.iframe.onload=l}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":8,"component-inherit":16}],7:[function(e,t,n){(function(n){var r=e("xmlhttprequest-ssl"),o=e("./polling"),i=e("component-emitter"),s=e("component-inherit"),a=e("debug")("engine.io-client:polling-xhr");t.exports=l,t.exports.Request=p;function c(){}function l(e){if(o.call(this,e),n.location){var t="https:"==location.protocol,r=location.port;r||(r=t?443:80),this.xd=e.hostname!=n.location.hostname||r!=e.port,this.xs=e.secure!=t}else this.extraHeaders=e.extraHeaders}s(l,o),l.prototype.supportsBinary=!0,l.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.extraHeaders=this.extraHeaders,new p(e)},l.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},l.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e};function p(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}i(p.prototype),p.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),o=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck(!0);for(var i in this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}}catch(e){}if(this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){o.onLoad()},t.onerror=function(){o.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?o.onLoad():setTimeout(function(){o.onError(t.status)},0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){o.onError(e)},0)}n.document&&(this.index=p.requestsCount++,p.requests[this.index]=this)},p.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},p.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},p.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},p.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}n.document&&delete p.requests[this.index],this.xhr=null}},p.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(e){}if("application/octet-stream"===t)e=this.xhr.response;else if(this.supportsBinary)try{e=String.fromCharCode.apply(null,new Uint8Array(this.xhr.response))}catch(t){for(var n=new Uint8Array(this.xhr.response),r=[],o=0,i=n.length;o<i;o++)r.push(n[o]);e=String.fromCharCode.apply(null,r)}else e=this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},p.prototype.hasXDR=function(){return void 0!==n.XDomainRequest&&!this.xs&&this.enablesXDR},p.prototype.abort=function(){this.cleanup()},n.document&&(p.requestsCount=0,p.requests={},n.attachEvent?n.attachEvent("onunload",u):n.addEventListener&&n.addEventListener("beforeunload",u,!1));function u(){for(var e in p.requests)p.requests.hasOwnProperty(e)&&p.requests[e].abort()}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./polling":8,"component-emitter":15,"component-inherit":16,debug:17,"xmlhttprequest-ssl":10}],8:[function(e,t,n){var r=e("../transport"),o=e("parseqs"),i=e("engine.io-parser"),s=e("component-inherit"),a=e("yeast"),c=e("debug")("engine.io-client:polling");t.exports=p;var l=null!=new(e("xmlhttprequest-ssl"))({xdomain:!1}).responseType;function p(e){var t=e&&e.forceBase64;l&&!t||(this.supportsBinary=!1),r.call(this,e)}s(p,r),p.prototype.name="polling",p.prototype.doOpen=function(){this.poll()},p.prototype.pause=function(e){var t=this;this.readyState="pausing";function n(){c("paused"),t.readyState="paused",e()}if(this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){c("pre-pause polling complete"),--r||n()})),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",function(){c("pre-pause writing complete"),--r||n()}))}else n()},p.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},p.prototype.onData=function(e){var t=this;c("polling got data %s",e);i.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"==t.readyState&&t.onOpen(),"close"==e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},p.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"==this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},p.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};t=this;i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,"xmlhttprequest-ssl":10,yeast:30}],9:[function(e,t,n){(function(n){var r=e("../transport"),o=e("engine.io-parser"),i=e("parseqs"),s=e("component-inherit"),a=e("yeast"),c=e("debug")("engine.io-client:websocket"),l=n.WebSocket||n.MozWebSocket,p=l;if(!p&&"undefined"==typeof window)try{p=e("ws")}catch(e){}t.exports=u;function u(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,r.call(this,e)}s(u,r),u.prototype.name="websocket",u.prototype.supportsBinary=!0,u.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t={agent:this.agent,perMessageDeflate:this.perMessageDeflate};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(t.headers=this.extraHeaders),this.ws=l?new p(e):new p(e,void 0,t),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="buffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},u.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(u.prototype.onData=function(e){var t=this;setTimeout(function(){r.prototype.onData.call(t,e)},0)}),u.prototype.write=function(e){var t=this;this.writable=!1;for(var r=e.length,i=0,s=r;i<s;i++)!function(e){o.encodePacket(e,t.supportsBinary,function(o){if(!l){var i={};if(e.options&&(i.compress=e.options.compress),t.perMessageDeflate){("string"==typeof o?n.Buffer.byteLength(o):o.length)<t.perMessageDeflate.threshold&&(i.compress=!1)}}try{l?t.ws.send(o):t.ws.send(o,i)}catch(e){c("websocket closed before onclose event")}--r||a()})}(e[i]);function a(){t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0)}},u.prototype.onClose=function(){r.prototype.onClose.call(this)},u.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||(e.b64=1),(e=i.encode(e)).length&&(e="?"+e);return t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},u.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===u.prototype.name)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"../transport":4,"component-inherit":16,debug:17,"engine.io-parser":19,parseqs:27,ws:void 0,yeast:30}],10:[function(e,t,n){var r=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,o=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&o)return new XDomainRequest}catch(e){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}},{"has-cors":22}],11:[function(e,t,n){t.exports=function(e,t,n){var o=!1;return n=n||r,i.count=e,0===e?t():i;function i(e,r){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,t(e),t=n):0!==i.count||o||t(null,r)}};function r(){}},{}],12:[function(e,t,n){t.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)i[a]=o[s];return i.buffer}},{}],13:[function(e,t,n){!function(e){"use strict";n.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},n.decode=function(t){var n,r,o,i,s,a=.75*t.length,c=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var p=new ArrayBuffer(a),u=new Uint8Array(p);for(n=0;n<c;n+=4)r=e.indexOf(t[n]),o=e.indexOf(t[n+1]),i=e.indexOf(t[n+2]),s=e.indexOf(t[n+3]),u[l++]=r<<2|o>>4,u[l++]=(15&o)<<4|i>>2,u[l++]=(3&i)<<6|63&s;return p}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],14:[function(e,t,n){(function(e){var n=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),i=n&&n.prototype.append&&n.prototype.getBlob;function s(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var o=new Uint8Array(n.byteLength);o.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=o.buffer}e[t]=r}}}function a(e,t){t=t||{};var r=new n;s(e);for(var o=0;o<e.length;o++)r.append(e[o]);return t.type?r.getBlob(t.type):r.getBlob()}function c(e,t){return s(e),new Blob(e,t||{})}t.exports=r?o?e.Blob:c:i?a:void 0}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],15:[function(e,t,n){t.exports=r;function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){var n=this;this._callbacks=this._callbacks||{};function r(){n.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],16:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],17:[function(e,t,n){(n=t.exports=e("./debug")).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var r="color: "+this.color,o=0,i=0;return(e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1)))[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&"%c"===e&&(i=++o)}),e.splice(i,0,r),e},n.save=function(e){try{null==e?n.storage.removeItem("debug"):n.storage.debug=e}catch(e){}},n.load=r,n.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];n.formatters.j=function(e){return JSON.stringify(e)};function r(){var e;try{e=n.storage.debug}catch(e){}return e}n.enable(r())},{"./debug":18}],18:[function(e,t,n){(n=t.exports=function(e){function t(){}t.enabled=!1;function i(){var e=i,t=+new Date,s=t-(r||t);e.diff=s,e.prev=r,e.curr=t,r=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=n.colors[o++%n.colors.length]);var a=Array.prototype.slice.call(arguments);a[0]=n.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var c=0;a[0]=a[0].replace(/%([a-z%])/g,function(t,r){if("%%"===t)return t;c++;var o=n.formatters[r];if("function"==typeof o){var i=a[c];t=o.call(e,i),a.splice(c,1),c--}return t}),"function"==typeof n.formatArgs&&(a=n.formatArgs.apply(e,a));var l=i.log||n.log||void 0;l.apply(e,a)}i.enabled=!0;var s=n.enabled(e)?i:t;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},n.disable=function(){n.enable("")},n.enable=function(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),r=t.length,o=0;o<r;o++)t[o]&&("-"===(e=t[o].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))},n.enabled=function(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1},n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var r,o=0},{ms:25}],19:[function(e,t,n){(function(t){var r=e("./keys"),o=e("has-binary"),i=e("arraybuffer.slice"),s=e("base64-arraybuffer"),a=e("after"),c=e("utf8"),l=navigator.userAgent.match(/Android/i),p=/PhantomJS/i.test(navigator.userAgent),u=l||p;n.protocol=3;var f=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=r(f),d={type:"error",data:"parser error"},y=e("blob");n.encodePacket=function(e,r,o,i){"function"==typeof r&&(i=r,r=!1),"function"==typeof o&&(i=o,o=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&s instanceof ArrayBuffer)return function(e,t,r){if(!t)return n.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=f[e.type];for(var a=0;a<i.length;a++)s[a+1]=i[a];return r(s.buffer)}(e,r,i);if(y&&s instanceof t.Blob)return function(e,t,r){if(!t)return n.encodeBase64Packet(e,r);if(u)return function(e,t,r){if(!t)return n.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){e.data=o.result,n.encodePacket(e,t,!0,r)},o.readAsArrayBuffer(e.data)}(e,t,r);var o=new Uint8Array(1);o[0]=f[e.type];var i=new y([o.buffer,e.data]);return r(i)}(e,r,i);if(s&&s.base64)return function(e,t){var r="b"+n.packets[e.type]+e.data.data;return t(r)}(e,i);var a=f[e.type];return void 0!==e.data&&(a+=o?c.encode(String(e.data)):String(e.data)),i(""+a)};n.encodeBase64Packet=function(e,r){var o="b"+n.packets[e.type];if(y&&e.data instanceof t.Blob){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];r(o+e)},i.readAsDataURL(e.data)}var s;try{s=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),c=new Array(a.length),l=0;l<a.length;l++)c[l]=a[l];s=String.fromCharCode.apply(null,c)}return o+=t.btoa(s),r(o)},n.decodePacket=function(e,t,r){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(r)try{e=c.decode(e)}catch(e){return d}var o=e.charAt(0);return Number(o)==o&&h[o]?e.length>1?{type:h[o],data:e.substring(1)}:{type:h[o]}:d}o=new Uint8Array(e)[0];var s=i(e,1);return y&&"blob"===t&&(s=new y([s])),{type:h[o],data:s}},n.decodeBase64Packet=function(e,n){var r=h[e.charAt(0)];if(!t.ArrayBuffer)return{type:r,data:{base64:!0,data:e.substr(1)}};var o=s.decode(e.substr(1));return"blob"===n&&y&&(o=new y([o])),{type:r,data:o}},n.encodePayload=function(e,t,r){"function"==typeof t&&(r=t,t=null);var i=o(e);if(t&&i)return y&&!u?n.encodePayloadAsBlob(e,r):n.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");m(e,function(e,r){n.encodePacket(e,!!i&&t,!0,function(e){r(null,(t=e).length+":"+t);var t})},function(e,t){return r(t.join(""))})};function m(e,t,n){for(var r=new Array(e.length),o=a(e.length,n),i=function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})},s=0;s<e.length;s++)i(s,e[s],o)}n.decodePayload=function(e,t,r){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,r);"function"==typeof t&&(r=t,t=null);var o;if(""==e)return r(d,0,1);for(var i,s,a="",c=0,l=e.length;c<l;c++){var p=e.charAt(c);if(":"!=p)a+=p;else{if(""==a||a!=(i=Number(a)))return r(d,0,1);if(a!=(s=e.substr(c+1,i)).length)return r(d,0,1);if(s.length){if(o=n.decodePacket(s,t,!0),d.type==o.type&&d.data==o.data)return r(d,0,1);if(!1===r(o,c+i,l))return}c+=i,a=""}}return""!=a?r(d,0,1):void 0},n.encodePayloadAsArrayBuffer=function(e,t){if(!e.length)return t(new ArrayBuffer(0));m(e,function(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,n){var r=n.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),o=new Uint8Array(r),i=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),s=0;s<e.length;s++)r[s]=e.charCodeAt(s);n=r.buffer}o[i++]=t?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)o[i++]=parseInt(a[s]);o[i++]=255;for(r=new Uint8Array(n),s=0;s<r.length;s++)o[i++]=r[s]}),t(o.buffer)})},n.encodePayloadAsBlob=function(e,t){m(e,function(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,n[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),s=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)s[o]=parseInt(i[o]);if(s[i.length]=255,y){var a=new y([n.buffer,s.buffer,e]);t(null,a)}})},function(e,n){return t(new y(n))})},n.decodePayloadAsBinary=function(e,t,r){"function"==typeof t&&(r=t,t=null);for(var o=e,s=[],a=!1;o.byteLength>0;){for(var c=new Uint8Array(o),l=0===c[0],p="",u=1;255!=c[u];u++){if(p.length>310){a=!0;break}p+=c[u]}if(a)return r(d,0,1);o=i(o,2+p.length),p=parseInt(p);var f=i(o,0,p);if(l)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(e){var h=new Uint8Array(f);f="";for(u=0;u<h.length;u++)f+=String.fromCharCode(h[u])}s.push(f),o=i(o,p)}var y=s.length;s.forEach(function(e,o){r(n.decodePacket(e,t,!0),o,y)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./keys":20,after:11,"arraybuffer.slice":12,"base64-arraybuffer":13,blob:14,"has-binary":21,utf8:29}],20:[function(e,t,n){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},{}],21:[function(e,t,n){(function(n){var r=e("isarray");t.exports=function(e){return function e(t){if(!t)return!1;if(n.Buffer&&n.Buffer.isBuffer(t)||n.ArrayBuffer&&t instanceof ArrayBuffer||n.Blob&&t instanceof Blob||n.File&&t instanceof File)return!0;if(r(t)){for(var o=0;o<t.length;o++)if(e(t[o]))return!0}else if(t&&"object"==typeof t){t.toJSON&&(t=t.toJSON());for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0}return!1}(e)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:24}],22:[function(e,t,n){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},{}],23:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],24:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],25:[function(e,t,n){var r=1e3,o=60*r,i=60*o,s=24*i,a=365.25*s;t.exports=function(e,t){return t=t||{},"string"==typeof e?function(e){if((e=""+e).length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*a;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return n*o;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}(e):t.long?c(l=e,s,"day")||c(l,i,"hour")||c(l,o,"minute")||c(l,r,"second")||l+" ms":(n=e)>=s?Math.round(n/s)+"d":n>=i?Math.round(n/i)+"h":n>=o?Math.round(n/o)+"m":n>=r?Math.round(n/r)+"s":n+"ms";var n,l};function c(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}},{}],26:[function(e,t,n){(function(e){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,i=/(?:^|:|,)(?:\s*\[)+/g,s=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(s,"").replace(a,""),e.JSON&&JSON.parse?JSON.parse(t):n.test(t.replace(r,"@").replace(o,"]").replace(i,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],27:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},{}],28:[function(e,t,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,n=e.indexOf("["),i=e.indexOf("]");-1!=n&&-1!=i&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));for(var s=r.exec(e||""),a={},c=14;c--;)a[o[c]]=s[c]||"";return-1!=n&&-1!=i&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],29:[function(e,t,n){(function(e){!function(r){var o="object"==typeof n&&n,i="object"==typeof t&&t&&t.exports==o&&t,s="object"==typeof e&&e;s.global!==s&&s.window!==s||(r=s);var a=String.fromCharCode;function c(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function l(e){if(e>=55296&&e<=57343)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function p(e,t){return a(e>>t&63|128)}function u(e){if(0==(4294967168&e))return a(e);var t="";return 0==(4294965248&e)?t=a(e>>6&31|192):0==(4294901760&e)?(l(e),t=a(e>>12&15|224),t+=p(e,6)):0==(4292870144&e)&&(t=a(e>>18&7|240),t+=p(e,12),t+=p(e,6)),t+=a(63&e|128)}function f(){if(m>=y)throw Error("Invalid byte index");var e=255&d[m];if(m++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(){var e,t;if(m>y)throw Error("Invalid byte index");if(m==y)return!1;if(e=255&d[m],m++,0==(128&e))return e;if(192==(224&e)){if((t=(31&e)<<6|f())>=128)return t;throw Error("Invalid continuation byte")}if(224==(240&e)){if((t=(15&e)<<12|f()<<6|f())>=2048)return l(t),t;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=(15&e)<<18|f()<<12|f()<<6|f())>=65536&&t<=1114111)return t;throw Error("Invalid UTF-8 detected")}var d,y,m;var g={version:"2.0.0",encode:function(e){for(var t=c(e),n=t.length,r=-1,o="";++r<n;)o+=u(t[r]);return o},decode:function(e){d=c(e),y=d.length,m=0;for(var t,n=[];!1!==(t=h());)n.push(t);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=a((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=a(t);return o}(n)}};if(o&&!o.nodeType)if(i)i.exports=g;else{var v={}.hasOwnProperty;for(var b in g)v.call(g,b)&&(o[b]=g[b])}else r.utf8=g}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],30:[function(e,t,n){"use strict";var r,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,s={},a=0,c=0;function l(e){var t="";do{t=o[e%i]+t,e=Math.floor(e/i)}while(e>0);return t}function p(){var e=l(+new Date);return e!==r?(a=0,r=e):e+"."+l(a++)}for(;c<i;c++)s[o[c]]=c;p.encode=l,p.decode=function(e){var t=0;for(c=0;c<e.length;c++)t=t*i+s[e.charAt(c)];return t},t.exports=p},{}],31:[function(e,t,n){var r=e("./url"),o=e("socket.io-parser"),i=e("./manager"),s=e("debug")("socket.io-client");t.exports=n=c;var a=n.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=r(e),c=o.source,l=o.id,p=o.path,u=a[l]&&p in a[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||u?(s("ignoring socket cache for %s",c),n=i(c,t)):(a[l]||(s("new io instance for %s",c),a[l]=i(c,t)),n=a[l]),n.socket(o.path)}n.protocol=o.protocol,n.connect=c,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":32,"./socket":34,"./url":35,debug:39,"socket.io-parser":47}],32:[function(e,t,n){var r=e("engine.io-client"),o=e("./socket"),i=e("component-emitter"),s=e("socket.io-parser"),a=e("./on"),c=e("component-bind"),l=e("debug")("socket.io-client:manager"),p=e("indexof"),u=e("backo2"),f=Object.prototype.hasOwnProperty;t.exports=h;function h(e,t){if(!(this instanceof h))return new h(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new u({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}h.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},h.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.engine.id)},i(h.prototype),h.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},h.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},h.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},h.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},h.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},h.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},h.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},h.prototype.open=h.prototype.connect=function(e){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=r(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=a(t,"open",function(){n.onopen(),e&&e()}),i=a(t,"error",function(t){if(l("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;l("connect attempt will timeout after %d",s);var c=setTimeout(function(){l("connect attempt timed out after %d",s),o.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(o),this.subs.push(i),this},h.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(a(e,"data",c(this,"ondata"))),this.subs.push(a(e,"ping",c(this,"onping"))),this.subs.push(a(e,"pong",c(this,"onpong"))),this.subs.push(a(e,"error",c(this,"onerror"))),this.subs.push(a(e,"close",c(this,"onclose"))),this.subs.push(a(this.decoder,"decoded",c(this,"ondecoded")))},h.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},h.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},h.prototype.ondata=function(e){this.decoder.add(e)},h.prototype.ondecoded=function(e){this.emit("packet",e)},h.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},h.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new o(this,e),this.nsps[e]=t;var n=this;t.on("connecting",r),t.on("connect",function(){t.id=n.engine.id}),this.autoConnect&&r()}function r(){~p(n.connecting,t)||n.connecting.push(t)}return t},h.prototype.destroy=function(e){var t=p(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},h.prototype.packet=function(e){l("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},h.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},h.prototype.cleanup=function(){l("cleanup");for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},h.prototype.close=h.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"==this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},h.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},h.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},h.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":33,"./socket":34,backo2:36,"component-bind":37,"component-emitter":38,debug:39,"engine.io-client":1,indexof:42,"socket.io-parser":47}],33:[function(e,t,n){t.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},{}],34:[function(e,t,n){var r=e("socket.io-parser"),o=e("component-emitter"),i=e("to-array"),s=e("./on"),a=e("component-bind"),c=e("debug")("socket.io-client:socket"),l=e("has-binary");t.exports=f;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},u=o.prototype.emit;function f(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.io.autoConnect&&this.open()}o(f.prototype),f.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},f.prototype.open=f.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this.emit("connecting"),this)},f.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},f.prototype.emit=function(e){if(p.hasOwnProperty(e))return u.apply(this,arguments),this;var t=i(arguments),n=r.EVENT;l(t)&&(n=r.BINARY_EVENT);var o={type:n,data:t};return o.options={},o.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),delete this.flags,this},f.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},f.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},f.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},f.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},f.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?u.apply(this,t):this.receiveBuffer.push(t)},f.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=i(arguments);c("sending ack %j",o);var s=l(o)?r.BINARY_ACK:r.ACK;t.packet({type:s,id:e,data:o})}}},f.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},f.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},f.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)u.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},f.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},f.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},f.prototype.close=f.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},f.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},{"./on":33,"component-bind":37,"component-emitter":38,debug:39,"has-binary":41,"socket.io-parser":47,"to-array":51}],35:[function(e,t,n){(function(n){var r=e("parseuri"),o=e("debug")("socket.io-client:url");t.exports=function(e,t){var i=e,t=t||n.location;null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(o("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),o("parse %s",e),i=r(e));i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443"));i.path=i.path||"/";var s=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port,i.href=i.protocol+"://"+s+(t&&t.port==i.port?"":":"+i.port),i}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{debug:39,parseuri:45}],36:[function(e,t,n){t.exports=r;function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},{}],37:[function(e,t,n){var r=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},{}],38:[function(e,t,n){t.exports=r;function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,o=0;o<n.length;o++)if((r=n[o])===t||r.fn===t){n.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],39:[function(e,t,n){arguments[4][17][0].apply(n,arguments)},{"./debug":40,dup:17}],40:[function(e,t,n){arguments[4][18][0].apply(n,arguments)},{dup:18,ms:44}],41:[function(e,t,n){(function(n){var r=e("isarray");t.exports=function(e){return function e(t){if(!t)return!1;if(n.Buffer&&n.Buffer.isBuffer&&n.Buffer.isBuffer(t)||n.ArrayBuffer&&t instanceof ArrayBuffer||n.Blob&&t instanceof Blob||n.File&&t instanceof File)return!0;if(r(t)){for(var o=0;o<t.length;o++)if(e(t[o]))return!0}else if(t&&"object"==typeof t){t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON());for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return!0}return!1}(e)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{isarray:43}],42:[function(e,t,n){arguments[4][23][0].apply(n,arguments)},{dup:23}],43:[function(e,t,n){arguments[4][24][0].apply(n,arguments)},{dup:24}],44:[function(e,t,n){arguments[4][25][0].apply(n,arguments)},{dup:25}],45:[function(e,t,n){arguments[4][28][0].apply(n,arguments)},{dup:28}],46:[function(e,t,n){(function(t){var r=e("isarray"),o=e("./is-buffer");n.deconstructPacket=function(e){var t=[],n=e.data;var i=e;return i.data=function e(n){if(!n)return n;if(o(n)){var i={_placeholder:!0,num:t.length};return t.push(n),i}if(r(n)){for(var s=new Array(n.length),a=0;a<n.length;a++)s[a]=e(n[a]);return s}if("object"==typeof n&&!(n instanceof Date)){s={};for(var c in n)s[c]=e(n[c]);return s}return n}(n),i.attachments=t.length,{packet:i,buffers:t}},n.reconstructPacket=function(e,t){return e.data=function e(n){if(n&&n._placeholder)return t[n.num];if(r(n)){for(var o=0;o<n.length;o++)n[o]=e(n[o]);return n}if(n&&"object"==typeof n){for(var i in n)n[i]=e(n[i]);return n}return n}(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,n){var i=0,s=e;!function e(a,c,l){if(!a)return a;if(t.Blob&&a instanceof Blob||t.File&&a instanceof File){i++;var p=new FileReader;p.onload=function(){l?l[c]=this.result:s=this.result,--i||n(s)},p.readAsArrayBuffer(a)}else if(r(a))for(var u=0;u<a.length;u++)e(a[u],u,a);else if(a&&"object"==typeof a&&!o(a))for(var f in a)e(a[f],f,a)}(s),i||n(s)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{"./is-buffer":48,isarray:43}],47:[function(e,t,n){var r=e("debug")("socket.io-parser"),o=e("json3"),i=(e("isarray"),e("component-emitter")),s=e("./binary"),a=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=c,n.Decoder=p;function c(){}c.prototype.encode=function(e,t){if(r("encoding packet %j",e),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)!function(e,t){s.removeBlobs(e,function(e){var n=s.deconstructPacket(e),r=l(n.packet),o=n.buffers;o.unshift(r),t(o)})}(e,t);else{t([l(e)])}};function l(e){var t="",i=!1;return t+=e.type,n.BINARY_EVENT!=e.type&&n.BINARY_ACK!=e.type||(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(i=!0,t+=e.nsp),null!=e.id&&(i&&(t+=",",i=!1),t+=e.id),null!=e.data&&(i&&(t+=","),t+=o.stringify(e.data)),r("encoded %j as %s",e,t),t}function p(){this.reconstructor=null}i(p.prototype),p.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t={},i=0;if(t.type=Number(e.charAt(0)),null==n.types[t.type])return f();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){for(var s="";"-"!=e.charAt(++i)&&(s+=e.charAt(i),i!=e.length););if(s!=Number(s)||"-"!=e.charAt(i))throw new Error("Illegal attachments");t.attachments=Number(s)}if("/"==e.charAt(i+1))for(t.nsp="";++i;){var a=e.charAt(i);if(","==a)break;if(t.nsp+=a,i==e.length)break}else t.nsp="/";var c=e.charAt(i+1);if(""!==c&&Number(c)==c){for(t.id="";++i;){var a=e.charAt(i);if(null==a||Number(a)!=a){--i;break}if(t.id+=e.charAt(i),i==e.length)break}t.id=Number(t.id)}if(e.charAt(++i))try{t.data=o.parse(e.substr(i))}catch(e){return f()}return r("decoded %s as %j",e,t),t}(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new u(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}};p.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()};function u(e){this.reconPack=e,this.buffers=[]}u.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=s.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},u.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};function f(e){return{type:n.ERROR,data:"parser error"}}},{"./binary":46,"./is-buffer":48,"component-emitter":49,debug:39,isarray:43,json3:50}],48:[function(e,t,n){(function(e){t.exports=function(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],49:[function(e,t,n){arguments[4][15][0].apply(n,arguments)},{dup:15}],50:[function(e,t,n){(function(e){(function(){var r={function:!0,object:!0},o=r[typeof n]&&n&&!n.nodeType&&n,i=r[typeof window]&&window||this,s=o&&r[typeof t]&&t&&!t.nodeType&&"object"==typeof e&&e;!s||s.global!==s&&s.window!==s&&s.self!==s||(i=s);function a(e,t){e||(e=i.Object()),t||(t=i.Object());var n=e.Number||i.Number,o=e.String||i.String,s=e.Object||i.Object,c=e.Date||i.Date,l=e.SyntaxError||i.SyntaxError,p=e.TypeError||i.TypeError,u=e.Math||i.Math,f=e.JSON||i.JSON;"object"==typeof f&&f&&(t.stringify=f.stringify,t.parse=f.parse);var h,d,y,m=s.prototype,g=m.toString,v=new c(-0xc782b5b800cec);try{v=-109252==v.getUTCFullYear()&&0===v.getUTCMonth()&&1===v.getUTCDate()&&10==v.getUTCHours()&&37==v.getUTCMinutes()&&6==v.getUTCSeconds()&&708==v.getUTCMilliseconds()}catch(e){}function b(e){if(b[e]!==y)return b[e];var r;if("bug-string-char-index"==e)r="a"!="a"[0];else if("json"==e)r=b("json-stringify")&&b("json-parse");else{var i,s='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var a=t.stringify,l="function"==typeof a&&v;if(l){(i=function(){return 1}).toJSON=i;try{l="0"===a(0)&&"0"===a(new n)&&'""'==a(new o)&&a(g)===y&&a(y)===y&&a()===y&&"1"===a(i)&&"[1]"==a([i])&&"[null]"==a([y])&&"null"==a(null)&&"[null,null,null]"==a([y,g,null])&&a({a:[i,!0,!1,null,"\0\b\n\f\r\t"]})==s&&"1"===a(null,i)&&"[\n 1,\n 2\n]"==a([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==a(new c(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==a(new c(864e13))&&'"-000001-01-01T00:00:00.000Z"'==a(new c(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==a(new c(-1))}catch(e){l=!1}}r=l}if("json-parse"==e){var p=t.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){var u=5==(i=p(s)).a.length&&1===i.a[0];if(u){try{u=!p('"\t"')}catch(e){}if(u)try{u=1!==p("01")}catch(e){}if(u)try{u=1!==p("1.")}catch(e){}}}}catch(e){u=!1}r=u}}return b[e]=!!r}if(!b("json")){var x="[object Function]",w="[object Number]",k="[object String]",I="[object Array]",T=b("bug-string-char-index");if(!v)var C=u.floor,B=[0,31,59,90,120,151,181,212,243,273,304,334],P=function(e,t){return B[t]+365*(e-1970)+C((e-1969+(t=+(t>1)))/4)-C((e-1901+t)/100)+C((e-1601+t)/400)};if((h=m.hasOwnProperty)||(h=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=g?h=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,h=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,h.call(this,e)}),d=function(e,t){var n,o,i,s=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,o=new n;for(i in o)h.call(o,i)&&s++;return n=o=null,s?d=2==s?function(e,t){var n,r={},o=g.call(e)==x;for(n in e)o&&"prototype"==n||h.call(r,n)||!(r[n]=1)||!h.call(e,n)||t(n)}:function(e,t){var n,r,o=g.call(e)==x;for(n in e)o&&"prototype"==n||!h.call(e,n)||(r="constructor"===n)||t(n);(r||h.call(e,n="constructor"))&&t(n)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],d=function(e,t){var n,i,s=g.call(e)==x,a=!s&&"function"!=typeof e.constructor&&r[typeof e.hasOwnProperty]&&e.hasOwnProperty||h;for(n in e)s&&"prototype"==n||!a.call(e,n)||t(n);for(i=o.length;n=o[--i];a.call(e,n)&&t(n));}),d(e,t)},!b("json-stringify")){var S={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},A=function(e,t){return("000000"+(t||0)).slice(-e)},E=function(e){for(var t='"',n=0,r=e.length,o=!T||r>10,i=o&&(T?e.split(""):e);n<r;n++){var s=e.charCodeAt(n);switch(s){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=S[s];break;default:if(s<32){t+="\\u00"+A(2,s.toString(16));break}t+=o?i[n]:e.charAt(n)}}return t+'"'},_=function(e,t,n,r,o,i,s){var a,c,l,u,f,m,v,b,x,T,B,S,D,M,H,R;try{a=t[e]}catch(e){}if("object"==typeof a&&a)if("[object Date]"!=(c=g.call(a))||h.call(a,"toJSON"))"function"==typeof a.toJSON&&(c!=w&&c!=k&&c!=I||h.call(a,"toJSON"))&&(a=a.toJSON(e));else if(a>-1/0&&a<1/0){if(P){for(f=C(a/864e5),l=C(f/365.2425)+1970-1;P(l+1,0)<=f;l++);for(u=C((f-P(l,0))/30.42);P(l,u+1)<=f;u++);f=1+f-P(l,u),v=C((m=(a%864e5+864e5)%864e5)/36e5)%24,b=C(m/6e4)%60,x=C(m/1e3)%60,T=m%1e3}else l=a.getUTCFullYear(),u=a.getUTCMonth(),f=a.getUTCDate(),v=a.getUTCHours(),b=a.getUTCMinutes(),x=a.getUTCSeconds(),T=a.getUTCMilliseconds();a=(l<=0||l>=1e4?(l<0?"-":"+")+A(6,l<0?-l:l):A(4,l))+"-"+A(2,u+1)+"-"+A(2,f)+"T"+A(2,v)+":"+A(2,b)+":"+A(2,x)+"."+A(3,T)+"Z"}else a=null;if(n&&(a=n.call(t,e,a)),null===a)return"null";if("[object Boolean]"==(c=g.call(a)))return""+a;if(c==w)return a>-1/0&&a<1/0?""+a:"null";if(c==k)return E(""+a);if("object"==typeof a){for(M=s.length;M--;)if(s[M]===a)throw p();if(s.push(a),B=[],H=i,i+=o,c==I){for(D=0,M=a.length;D<M;D++)S=_(D,a,n,r,o,i,s),B.push(S===y?"null":S);R=B.length?o?"[\n"+i+B.join(",\n"+i)+"\n"+H+"]":"["+B.join(",")+"]":"[]"}else d(r||a,function(e){var t=_(e,a,n,r,o,i,s);t!==y&&B.push(E(e)+":"+(o?" ":"")+t)}),R=B.length?o?"{\n"+i+B.join(",\n"+i)+"\n"+H+"}":"{"+B.join(",")+"}":"{}";return s.pop(),R}};t.stringify=function(e,t,n){var o,i,s,a;if(r[typeof t]&&t)if((a=g.call(t))==x)i=t;else if(a==I){s={};for(var c,l=0,p=t.length;l<p;c=t[l++],a=g.call(c),(a==k||a==w)&&(s[c]=1));}if(n)if((a=g.call(n))==w){if((n-=n%1)>0)for(o="",n>10&&(n=10);o.length<n;o+=" ");}else a==k&&(o=n.length<=10?n:n.slice(0,10));return _("",((c={})[""]=e,c),i,s,o,"",[])}}if(!b("json-parse")){var D,M,H=o.fromCharCode,R={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},O=function(){throw D=M=null,l()},j=function(){for(var e,t,n,r,o,i=M,s=i.length;D<s;)switch(o=i.charCodeAt(D)){case 9:case 10:case 13:case 32:D++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=T?i.charAt(D):i[D],D++,e;case 34:for(e="@",D++;D<s;)if((o=i.charCodeAt(D))<32)O();else if(92==o)switch(o=i.charCodeAt(++D)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=R[o],D++;break;case 117:for(t=++D,n=D+4;D<n;D++)(o=i.charCodeAt(D))>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||O();e+=H("0x"+i.slice(t,D));break;default:O()}else{if(34==o)break;for(o=i.charCodeAt(D),t=D;o>=32&&92!=o&&34!=o;)o=i.charCodeAt(++D);e+=i.slice(t,D)}if(34==i.charCodeAt(D))return D++,e;O();default:if(t=D,45==o&&(r=!0,o=i.charCodeAt(++D)),o>=48&&o<=57){for(48==o&&(o=i.charCodeAt(D+1),o>=48&&o<=57)&&O(),r=!1;D<s&&(o=i.charCodeAt(D),o>=48&&o<=57);D++);if(46==i.charCodeAt(D)){for(n=++D;n<s&&(o=i.charCodeAt(n),o>=48&&o<=57);n++);n==D&&O(),D=n}if(101==(o=i.charCodeAt(D))||69==o){for(43!=(o=i.charCodeAt(++D))&&45!=o||D++,n=D;n<s&&(o=i.charCodeAt(n),o>=48&&o<=57);n++);n==D&&O(),D=n}return+i.slice(t,D)}if(r&&O(),"true"==i.slice(D,D+4))return D+=4,!0;if("false"==i.slice(D,D+5))return D+=5,!1;if("null"==i.slice(D,D+4))return D+=4,null;O()}return"$"},N=function(e){var t,n;if("$"==e&&O(),"string"==typeof e){if("@"==(T?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=j());n||(n=!0))n&&(","==e?"]"==(e=j())&&O():O()),","==e&&O(),t.push(N(e));return t}if("{"==e){for(t={};"}"!=(e=j());n||(n=!0))n&&(","==e?"}"==(e=j())&&O():O()),","!=e&&"string"==typeof e&&"@"==(T?e.charAt(0):e[0])&&":"==j()||O(),t[e.slice(1)]=N(j());return t}O()}return e},F=function(e,t,n){var r=U(e,t,n);r===y?delete e[t]:e[t]=r},U=function(e,t,n){var r,o=e[t];if("object"==typeof o&&o)if(g.call(o)==I)for(r=o.length;r--;)F(o,r,n);else d(o,function(e){F(o,e,n)});return n.call(e,t,o)};t.parse=function(e,t){var n,r;return D=0,M=""+e,n=N(j()),"$"!=j()&&O(),D=M=null,t&&g.call(t)==x?U(((r={})[""]=n,r),"",t):n}}}return t.runInContext=a,t}if(o)a(i,o);else{var c=i.JSON,l=i.JSON3,p=!1,u=a(i,i.JSON3={noConflict:function(){return p||(p=!0,i.JSON=c,i.JSON3=l,c=l=null),u}});i.JSON={parse:u.parse,stringify:u.stringify}}}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{})},{}],51:[function(e,t,n){t.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},{}]},{},[31])(31)}),stop_sounds();function tutor(){tutorsteps=[!1,!1,!1],signDiv.style.display="none",deathDiv.style.display="none",gameDiv.style.display="none",document.getElementById("tutorDiv").style.display="inline-block",wants=!0,incircle=0,setTimeout(play,10)}function play_tip(){disscore&&document.getElementById("audiotag12").play()}function hex_rv(e){if("#"==e.charAt(0)&&7==e.length){for(var t="#",n=1;n<7;n++){var r=parseInt(e.charAt(n),16);if(!(0<=r&&r<16))return"#000000";t+=(r=15-r).toString(16).toUpperCase()}return t}return"#000000"}getDistance=function(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))},gettime=function(){return d=new Date,d.getTime()};var WIDTH=window.innerWidth,HEIGHT=window.innerHeight;const cell_immune=[0,20,40,80,1e9,1e9];document.getElementById("ctx").width=WIDTH,document.getElementById("ctx").height=HEIGHT;var mini=document.getElementById("minimap").getContext("2d"),socket=null,entermed=0,exitmed=0,stage=4,tutorsteps=[!1,!1,!1],startti=0,wants=!1,endti=0,sizeX=5e3,numcells=0,sizeY=5e3,finalscore=0,ino=!0,numvirus=0,numplayers=0,iradtimer=0,x=0,y=0,intensity=0,mousex=0,mousey=0,selfx=0,selfy=0,lastx=0,lasty=0,reset=!1,playing=!1,medicine=[],scores=[],names=[],resettimer=100,numcancer=0,cancerwaslast=!0,alerts=["Enter!","",""],tooltips=["Press enter ↵ to cycle through display tips","",""],ontip=0;const viewtips=["This is how many viruses you have","This is how many cancer cells there are","This is how many red cells you have infected","This is your resistance to green medicine","This is your resistance to blue medicine","This is your resistance to purple medicine","This is your score",""];getleader(),void 0!==Cookies.get("topscore")&&Cookies.get("topscore")>0&&(document.getElementById("welcome").style.display="inline-block",document.getElementById("cookiescore").innerHTML=Number(Cookies.get("topscore")).toLocaleString());var signDiv=document.getElementById("signDiv"),deathDiv=document.getElementById("deathDiv"),signDivUsername=document.getElementById("signDiv-username"),handle=Cookies.get("name");void 0!==handle&&(signDivUsername.value=handle);var signDivSignIn=document.getElementById("signDiv-signIn");getDistance=function(e,t,n,r){return Math.sqrt(Math.pow(e-n,2)+Math.pow(t-r,2))};function addtooltip(e){a3[e]||(a3[e]=!0,alerts.unshift(a1[e]),tooltips.unshift(a2[e]),play_tip())}signDivSignIn.onclick=function(){playp()},playp=function(){disscore=!1,ontip=7,play()},play=function(){Cookies.set("name",signDivUsername.value+"");var e=document.getElementById("serverSelect").selected;socket=io.connect(e),document.getElementById("tutorDiv").display="none",socket.emit("signIn",{username:signDivUsername.value}),playing=!0,socket.on("medicine",function(e){medicine=e}),socket.on("signInResponse",function(e){e.success?(signDiv.style.display="none",deathDiv.style.display="none",gameDiv.style.display="inline-block",document.getElementById("tutorDiv").style.display="none",wants?(ino=!1,selfx=500,selfy=500):ino=!0,main()):alert("This server is full, you have been autoredirected to spectator mode")}),socket.on("scores",function(e){scorelist=e}),socket.on("co",function(e){e&&addtooltip(15)}),socket.on("evalAnswer",function(e){}),socket.on("resetall",function(e){reset=!0}),socket.on("stage",function(e){stage=e,counter>20&&(1===stage?play_powerup():2===stage?play_damage():3===stage&&play_powerdown())}),socket.on("death",function(e){deathDiv.style.display="inline-block",gameDiv.style.display="inline-block",finalscore=Math.round(Player.list[selfId].infects*(100*(1-Player.list[selfId].dmg[0])*(100*(1-Player.list[selfId].dmg[1])))*(100*(1-Player.list[selfId].dmg[2]))),stop_sounds(),document.getElementById("scored").innerHTML="Final score: "+finalscore;var t=Cookies.get("topscore");isNaN(t)||t<finalscore?(Cookies.set("topscore",finalscore),document.getElementById("best").style.display="inline-block"):document.getElementById("best").style.display="none"}),socket.on("init",function(e){e.selfId&&(selfId=e.selfId);for(var t=0;t<e.player.length;t++)new Player(e.player[t]);for(t=0;t<e.cell.length;t++)new Cell(e.cell[t])}),socket.on("remove",function(e){for(var t=0;t<e.player.length;t++)delete Player.list[e.player[t]];for(t=0;t<e.cell.length;t++)cell=Cell.list[e.cell[t]],void 0!==cell?cell.type?cell.phase=!0:cell.prephase=!0:delete Cell.list[self.id]}),socket.on("update",function(e){for(var t=0;t<e.player.length;t++){var n=e.player[t],r=Player.list[n.id];r&&(void 0!==n.x&&(r.x=n.x),void 0!==n.y&&(r.y=n.y),void 0!==n.hp&&(r.hp=n.hp),void 0!==n.immunity&&(r.dmg=n.immunity),void 0!==n.infects&&(n.infects!==r.infects&&r.id===selfId&&(counterp=counter+50),r.infects=n.infects),void 0!==n.avg&&(r.avg=n.avg),void 0!==n.color&&(r.color=n.color),void 0!==n.name&&(r.name=n.name))}for(t=0;t<e.cell.length;t++){n=e.cell[t];var o=Cell.list[e.cell[t].id];o&&(void 0!==n.x&&(o.x=n.x),void 0!==n.y&&(o.y=n.y),void 0!==n.create&&(o.create=n.create),void 0!==n.cells&&(o.cells=n.cells),void 0!==n.size&&(o.size=n.size))}}),document.onkeydown=function(e){68===e.keyCode?socket.emit("evalServer","placeRadiation()"):86===e.keyCode?socket.emit("evalServer","Player.list["+selfId+"].createnew("+selfx+","+selfy+");"):84===e.keyCode?(disscore=!disscore)||(ontip=7):32===e.keyCode?(tutorsteps[0]=!0,selfx=Player.list[selfId].x[0],selfy=Player.list[selfId].y[0]):13===e.keyCode?(addtooltip(1),play_click(),8===++ontip&&(ontip=0)):82===e.keyCode?socket.emit("evalServer","rad()"):77===e.keyCode?socket.emit("evalServer","placeMedicine("+selfx+","+selfy+",0);"):87===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",4,false,25)"):49===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",1,true)"):50===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",2,true)"):51===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",3,true)"):52===e.keyCode?socket.emit("evalServer","createCell("+selfx+","+selfy+",4,true)"):84===e.keyCode?socket.emit("evalServer","delay"):67===e.keyCode&&socket.emit("evalServer","createCancerCell("+selfx+","+selfy+",1)")}};var scorelist=[],radstop=0;drawminimap=function(){mini.save(),mini.clearRect(0,0,150,150),mini.restore()};var Img={};Img.player=new Image,Img.player.src="/client/img/player.png",Img.bullet=new Image,Img.bullet.src="/client/img/bullet.png",Img.map=new Image,Img.map.src="/client/img/map.png";var ctx=document.getElementById("ctx").getContext("2d");ctx.font="30px Arial";var Player=function(e){var t={};return t.id=e.id,t.x=e.x,t.y=e.y,t.hp=e.hp,t.hpMax=e.hpMax,t.dmg=e.immunity,t.avg=e.avg,t.color=String(e.color),t.infects=0,t.introuble=!1,t.name=e.name,t.draw=function(){if(t.id){ino&&(selfx=Player.list[selfId].x[0],selfy=Player.list[selfId].y[0],ino=!1);var e=t.x[0]-selfx+WIDTH/2,n=t.y[0]-selfy+HEIGHT/2;if(ctx.beginPath(),ctx.fillStyle=t.color,t.id===selfId){wants&&(incircle<t.x.length?0===t.infects&&(ctx.globalAlpha=1,ctx.font="bold 40px Arial",ctx.fillStyle="black",ctx.fillText("These are your viruses",e-200,n-50)):ctx.globalAlpha=0,ctx.globalAlpha=1);e=mousex,n=mousey;ctx.beginPath(),ctx.arc(e,n,500,0,2*Math.PI)}ctx.stroke();for(var r in t.x){numvirus++,ctx.fillStyle=t.color,mini.fillStyle=t.color,mini.fillRect(t.x[r]/sizeX*150-2,t.y[r]/sizeY*150-2,4,4);e=t.x[r]-selfx+WIDTH/2,n=t.y[r]-selfy+HEIGHT/2,Img.player.width,Img.player.height;void 0!==medicine[0]&&getDistance(t.x[r],t.y[r],medicine[0],medicine[1])<medicine[2]&&Player.list[selfId].dmg[medicine[4]]>.001?t.introuble=!0:t.introuble=!1,t.introuble?t.id===selfId?(drawFlu(e,n,8,timer,hex_rv(t.color)),inmed++,play_med()):drawFlu(e,n,8,timer,t.color):(drawFlu(e,n,8,timer,1===stage&&counter%16<8?hex_rv(t.color):t.color),document.getElementById("audiotag5").pause()),ctx.fillStyle="black"}}},Player.list[t.id]=t,t};Player.list={},drawMed=function(){if(void 0!==medicine[1]){ctx.beginPath(),mini.beginPath(),0===medicine[4]?(addtooltip(2),ctx.fillStyle="#39FF14",mini.fillStyle="#39FF14"):1===medicine[4]?(addtooltip(3),ctx.fillStyle="#00CCFF",mini.fillStyle="#00CCFF"):2===medicine[4]&&(addtooltip(4),ctx.fillStyle="#FF1DCE",mini.fillStyle="#FF1DCE");var e=medicine[0]-selfx+WIDTH/2,t=medicine[1]-selfy+HEIGHT/2;ctx.globalAlpha=medicine[3],mini.globalAlpha=medicine[3],ctx.arc(e,t,medicine[2],0,2*Math.PI),mini.arc(medicine[0]/sizeX*150,medicine[1]/sizeY*150,medicine[2]/sizeX*150,0,2*Math.PI),ctx.fill(),mini.fill(),ctx.globalAlpha=1,mini.globalAlpha=1,mini.fillStyle="black"}};var Cell=function(e){var t={};return t.id=e.id,t.x=e.x,t.y=e.y,t.size=e.size,t.create=e.create,t.type=e.type,t.cells=e.cells,t.cancer=e.cancer,t.eat=null,t.mag=null,t.phase=!1,t.phaser=1,t.prephase=!1,t.prephaser=2,t.lastcells=0,t.draw=function(){var e=t.cells;numcells++,t.lastcells!==t.cells&&(t.lastcells=t.cells,t.type||play_slurp()),t.prephase&&(t.prephaser-=.1,t.type||(t.size=20*t.cells+25),t.prephaser<.1&&(t.phase=!0)),t.cancer&&numcancer++;var n=t.x-selfx+WIDTH/2,r=t.y-selfy+HEIGHT/2;if(t.type){if(t.phase&&(t.phaser-=.1,t.phaser<=.1))return void delete Cell.list[t.id];if(ctx.globalAlpha=t.phaser,t.cells>0&&1===stage&&counter%16<8){for(ctx.fillStyle="#ffc0cb",t.cancer?drawCell(n,r,t.size,"#00134C","#3366ff"):drawCell(n,r,t.size,"#003F34","#009982");t.cells>0;)drawFlu(n+t.size/2-50*t.cells+25,r+t.size/2-50*t.cells+25,10,timer,"green",0),t.cells-=1;t.cells=e}else{for(ctx.fillStyle="#003f34",t.cancer?(drawCell(n,r,t.size,"#FFECB3","#CC9900"),play_cancer()):Player.list[selfId].avg<(cell_immune[Math.round(t.size/50)]||t.size/50>=4)||t.cells>0?drawCell(n,r,t.size,"pink","#FF667D"):(50===t.size?addtooltip(5):addtooltip(14),drawCell(n,r,t.size,"black","#FF667D"),ctx.beginPath(),ctx.arc(n,r,t.size,0,2*Math.PI),ctx.stroke(),ctx.lineWidth=2);t.cells>0;)drawFlu(n+t.size/2-50*t.cells+25,r+t.size/2-50*t.cells+25,10,timer,"green",0),t.cells-=1;t.cells=e}}else{if(t.phase&&(t.phaser-=.1,t.phaser<=.1))return void delete Cell.list[t.id];for(ctx.globalAlpha=t.phaser,drawCell(n,r,.8*t.size,"gray","white");t.cells>0;)drawFlu(n+t.size/2-24*t.cells+5,r+t.size/2-24*t.cells+5,10,timer,"green",0),t.cells-=1;t.cells=e}ctx.globalAlpha=1},Cell.list[t.id]=t,t};Cell.list={};var selfId=null,counterp=1e8;function updatexy(){if(getDistance(WIDTH/2+8,HEIGHT/2+8,mousex,mousey)<10)socket.emit("keyPress",{inputId:"mouseX",state:[selfx,selfy]});else{var e=mousex+selfx-WIDTH/2,t=mousey+selfy-HEIGHT/2;socket.emit("keyPress",{inputId:"mouseX",state:[e,t]})}}var timer=0,pulser=0,counter=0,down=!1;function updatePulser(){pulser>5?down=!0:pulser<-5&&(pulser+=.5,down=!1),down?pulser-=.5:pulser+=.5}main=function(){if(startti=gettime(),mini.clearRect(0,0,150,150),drawminimap(),counter===counterp&&play_death(),ctx.clearRect(0,0,WIDTH,HEIGHT),inmed=0,selfId){updatePulser(),void 0!=Player.list[selfId]&&(selfy=(mousey-HEIGHT/2)/20+selfy,(selfx=(mousex-WIDTH/2)/20+selfx)<WIDTH/2&&(selfx=WIDTH/2),selfy<HEIGHT/2&&(selfy=HEIGHT/2),selfx>sizeX-WIDTH/2&&(selfx=sizeX-WIDTH/2),selfy>sizeY-HEIGHT/2&&(selfy=sizeY-HEIGHT/2)),ctx.fillStyle="white",ctx.fillRect(x,y,sizeX,sizeY),ctx.globalAlpha=intensity,ctx.fillStyle="black",ctx.fillRect(0,0,WIDTH,HEIGHT),ctx.globalAlpha=1,drawMap(),drawMed(),updatexy(),incircle=0;for(var e=0;e<Player.list[selfId].x.length;e++)getDistance(selfx+(mousex-WIDTH/2),selfy+(mousey-HEIGHT/2),Player.list[selfId].x[e],Player.list[selfId].y[e])<500?incircle++:wants&&(ctx.globalAlpha=.4,ctx.fillStyle=hex_rv(Player.list[selfId].color),ctx.beginPath(),ctx.arc(Player.list[selfId].x[e]-selfx+WIDTH/2,Player.list[selfId].y[e]-selfy+HEIGHT/2,40,0,2*Math.PI),ctx.stroke(),ctx.fill());ctx.globalAlpha=1;for(var e in Player.list)Player.list[e].draw();for(var e in Cell.list)Cell.list[e].draw();if(Player.list[selfId]&&drawScoreboard(),reset&&(document.getElementById("audiotag8").pause(),play_host_revival(),ctx.fillStyle="white",ctx.globalAlpha=resettimer/100,ctx.fillRect(0,0,WIDTH,HEIGHT),ctx.fillStyle="black",ctx.font="160px ubuntu",ctx.fillText("REVIVED!",WIDTH/2-300,HEIGHT/2-20),resettimer-=1.5,ctx.globalAlpha=1,resettimer<=0&&(reset=!1,resettimer=100)),ctx.beginPath(),ctx.arc(mousex,mousey,500,0,2*Math.PI),ctx.stroke(),wants){incircle=0,ctx.font="bold 40px Arial",ctx.fillStyle="black",wants&&!tutorsteps[0]&&ctx.fillText("Press SPACE to find your viruses",mousex-300,mousey-50);for(e=0;e<Player.list[selfId].x.length;e++)getDistance(selfx+(mousex-WIDTH/2),selfy+(mousey-HEIGHT/2),Player.list[selfId].x[e],Player.list[selfId].y[e])<500&&incircle++;incircle<Player.list[selfId].x.length&&tutorsteps[0]?ctx.fillText("Keep your viruses inside your mouse circle",mousex-400,mousey-50):!0===tutorsteps[0]&&inmed>0?(ctx.fillText("Escape the medicine before it kills you!",mousex-300,mousey-50),0===entermed&&(entermed=counter,exitmed=0)):!0===tutorsteps[0]&&0===inmed&&(entermed>0||exitmed>0)?(0===exitmed&&(exitmed=counter+90,entermed=0),counter<exitmed&&ctx.fillText("What doesn't kill you makes you stronger!",mousex-400,mousey-50)):!0===tutorsteps[0]&&0===Player.list[selfId].infects?ctx.fillText("Attack a small red cell until it fills up",mousex-350,mousey-50):!0===tutorsteps[0]&&Player.list[selfId].infects>0&&counter<300&&ctx.fillText("Congratulations! You replicated your virus.",mousex-400,mousey-50)}intensity=numcancer/(numvirus+1),intensity=Math.pow(intensity,2),timer++,counter++,numcancer=0,numcells=0,numvirus=0,endti=gettime(),delay=40-(endti-startti)<=0?0:1e3/30-(endti-startti),setTimeout(main,delay)}};function drawGrid(e,t,n,r,o,i,s,a){ctx.save(),ctx.globalAlpha=.5,ctx.translate(e,t),ctx.beginPath(),ctx.strokeColor=i,ctx.lineWidth=2;for(var c=0;c<n||c<r;c+=o)ctx.moveTo(0,c),ctx.lineTo(n,c),ctx.moveTo(c+s%o,0),ctx.lineTo(c+s%o,r);ctx.strokeStyle=i,ctx.stroke(),ctx.closePath(),ctx.restore()}var drawMap=function(){var e=WIDTH/2-selfx,t=HEIGHT/2-selfy;counter<radstop||4===stage?(ctx.fillStyle="white",drawGrid(e,t,sizeX,sizeY,50,"#BFBFBF",0,0)):1===stage?(ctx.fillStyle="#070707",addtooltip(6),ctx.fillRect(e,t,sizeX,sizeY),drawGrid(e,t,sizeX,sizeY,50,"#404040",0,0)):(ctx.fillStyle="white",drawGrid(e,t,sizeX,sizeY,50,"#BFBFBF",0,0))},drawScore=function(){ctx.fillStyle="white"};drawBox=function(e,t,n,r){ctx.fillStyle="#FFFF00",ctx.globalAlpha=.5,ctx.beginPath(),ctx.arc(e,t,r,.5*Math.PI,-.5*Math.PI),ctx.lineTo(e+n,t-r),ctx.arc(e+n,t,r,-.5*Math.PI,.5*Math.PI),ctx.lineTo(e,t+r),ctx.stroke(),ctx.fill(),ctx.globalAlpha=1};var widthsofboxes=[690,750,850,500,500,500,400,0],heightsofboxes=[50,50,50,20,20,20,50,0],drawScoreboard=function(){if(Player.list[selfId].dmg[0]<.99&&addtooltip(11),Player.list[selfId].dmg[1]<.99&&addtooltip(12),Player.list[selfId].dmg[2]<.99&&addtooltip(13),ontip<3||6===ontip){ctx.font="40px ubuntu";var e=30}else{ctx.font="20px ubuntu";e=15}for(var t=0;t<ontip;t++)e+=heightsofboxes[t];7!==ontip&&drawBox(0,e,widthsofboxes[ontip]+50,heightsofboxes[ontip]/2),ctx.fillStyle="black",ontip<3||ontip>=6?7!==ontip?ctx.fillText(viewtips[ontip]+" ↵",150,e+10):ctx.fillText("",150,e+10):ctx.fillText(viewtips[ontip]+" ("+Math.round(100*(1-Player.list[selfId].dmg[ontip-3]))+"%) ↵",150,e+5);var n="<table style = 'font-size:30px;'>";for(t=0;t<3;t++)n+="<tr><td><b>"+alerts[t]+"</b></td><td>"+tooltips[t]+"</td><td></tr>";n+="</table>",document.getElementById("vvv").innerHTML=disscore?n:"";var r="<table id = 'leadertable' style = 'font-size:23.5px;'><caption>Scoreboard</caption>",o=0;for(t=0;t<scorelist.length;t++){var i=scorelist[t];if(void 0!==Player.list[i]){var s=Math.round(Player.list[i].infects*(100*(1-Player.list[i].dmg[0])*(100*(1-Player.list[i].dmg[1])))*(100*(1-Player.list[i].dmg[2])));s>1e3&&s<1e6?s=Math.floor(s/1e3)+"K":s>1e6&&(s=Math.floor(s/1e6)+"M"),r+="<tr><td>"+(t+1)+".</td><td style = 'overflow:hidden;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"+Player.list[i].name.substr(0,6)+"</td><td>"+s+"</td><td></tr>",drawFlu(WIDTH-215,30*o+70,8,0,Player.list[i].color),o++}}r+="</table>",document.getElementById("scoreboard").innerHTML=r,ctx.fillStyle="black",ctx.globalAlpha=.5,ctx.fillStyle="black",ctx.globalAlpha=1,drawFlu(20,30,10,timer,Player.list[selfId].color),drawCell(20,130,14,"pink","#FF667D"),drawCell(20,80,14,"#FFECB3","#CC9900"),ctx.font="40px ubuntu",ctx.fillText(Math.round(Player.list[selfId].infects),40,140),1===Math.round(Player.list[selfId].infects)&&addtooltip(9),ctx.fillText(Math.round(Player.list[selfId].infects*(100*(1-Player.list[selfId].dmg[0])*(100*(1-Player.list[selfId].dmg[1])))*(100*(1-Player.list[selfId].dmg[2]))),0,250),ctx.font="30px ubuntu",ctx.font="40px ubuntu",0!==numcancer&&cancerwaslast&&(play_cancer_spawn(),cancerwaslast=!1),cancerwaslast||0!==numcancer?0===numcancer&&(cancerwaslast=!0):addtooltip(10),numcancer>0&&addtooltip(7);var a=Player.list[selfId].x;ctx.fillText(a.length,40,40),ctx.fillText(numcancer,40,90),ctx.strokeStyle="#39FF14",ctx.strokeRect(0,155,100,20),ctx.strokeStyle="#00CCFF",ctx.strokeRect(0,175,100,20),ctx.strokeStyle="#FF1DCE",ctx.strokeRect(0,195,100,20),ctx.globalAlpha=.5,ctx.fillStyle="#39FF14",ctx.fillRect(0,155,100*(1-Player.list[selfId].dmg[0]),20),ctx.fillStyle="#00CCFF",ctx.fillRect(0,175,100*(1-Player.list[selfId].dmg[1]),20),ctx.fillStyle="#FF1DCE",ctx.fillRect(0,195,100*(1-Player.list[selfId].dmg[2]),20),ctx.globalAlpha=1,ctx.strokeStyle="black",ctx.fillStyle="gray",intensity>.5&&(addtooltip(8),intensity>1&&(document.getElementById("audiotag7").pause(),play_host_death()))};drawCell=function(e,t,n,r,o,i,s){if(ctx.save(),ctx.strokeStyle=r,ctx.lineWidth=n/10,ctx.fillStyle=o,ctx.translate(e,t),ctx.fillStyle=r,ctx.beginPath(),ctx.arc(0,0,n,0,2*Math.PI),ctx.fill(),ctx.fillStyle=o,ctx.beginPath(),ctx.arc(0,0,n*(.9+pulser/200),0,2*Math.PI),ctx.fill(),void 0!==i){var a=Math.cos(i/180*Math.PI)*n,c=Math.sin(i/180*Math.PI)*n;ctx.fillStyle="#ffc0cb",ctx.beginPath(),ctx.arc(.95*a,.95*c,n*(.1*s),0,2*Math.PI),ctx.fill(),ctx.fillStyle="white",ctx.beginPath(),ctx.arc(a,c,n*(.1*s),0,2*Math.PI),ctx.fill()}ctx.restore()};function drawFlu(e,t,n,r,o,i){var s=0;s=void 0!==i?i:.5,ctx.save(),ctx.translate(e,t),ctx.lineWidth=3,ctx.rotate(r*(Math.PI/180)),ctx.lineCap="round",ctx.beginPath(),ctx.arc(0,0,n,0,2*Math.PI),ctx.stroke(),ctx.moveTo(0,-1*n),ctx.lineTo(0,1.5*n*-1),ctx.stroke(),ctx.moveTo(0,1*n),ctx.lineTo(0,1.5*n*1),ctx.stroke(),ctx.moveTo(-1*n,0),ctx.lineTo(1.5*n*-1,0),ctx.stroke(),ctx.moveTo(1*n,0),ctx.lineTo(1.5*n*1,0),ctx.stroke(),ctx.rotate(Math.PI/180*45),ctx.moveTo(0,-1*n),ctx.lineTo(0,1.5*n*-1),ctx.stroke(),ctx.moveTo(0,1*n),ctx.lineTo(0,1.5*n*1),ctx.stroke(),ctx.moveTo(-1*n,0),ctx.lineTo(1.5*n*-1,0),ctx.stroke(),ctx.moveTo(1*n,0),ctx.lineTo(1.5*n*1,0),ctx.stroke(),ctx.fillStyle=o,ctx.globalAlpha=s,ctx.fill(),ctx.restore()}function drawLis(e,t,n,r,o){ctx.save(),ctx.translate(e,t),ctx.lineWidth=3,ctx.rotate(r*(Math.PI/180)),ctx.lineCap="round",ctx.beginPath(),ctx.arc(0,0,n,0,1*Math.PI),ctx.lineTo(-1*n,-2*n),ctx.arc(0,-2*n,n,1*Math.PI,2*Math.PI),ctx.lineTo(n,0),ctx.stroke(),ctx.moveTo(0,-3*n),ctx.lineTo(0,3.5*n*-1),ctx.stroke(),ctx.moveTo(0,1*n),ctx.lineTo(0,1.5*n*1),ctx.stroke(),ctx.moveTo(-1*n,0),ctx.lineTo(1.5*n*-1,0),ctx.stroke(),ctx.moveTo(1*n,0),ctx.lineTo(1.5*n*1,0),ctx.stroke(),ctx.rotate(Math.PI/180*45),ctx.moveTo(0,1*n),ctx.lineTo(0,1.5*n*1),ctx.stroke(),ctx.moveTo(1*n,0),ctx.lineTo(1.5*n*1,0),ctx.stroke(),ctx.rotate(Math.PI/180*-45),ctx.moveTo(1*n,-1*n*1),ctx.lineTo(1.5*n*1,-1*n*1),ctx.stroke(),ctx.moveTo(-1*n,-1*n*1),ctx.lineTo(1.5*n*-1,-1*n*1),ctx.stroke(),ctx.moveTo(0,-3*n),ctx.lineTo(0,3.5*n*-1),ctx.stroke(),ctx.moveTo(-1*n,-2*n),ctx.lineTo(1.5*n*-1,-2*n),ctx.stroke(),ctx.moveTo(1*n,-2*n),ctx.lineTo(1.5*n*1,-2*n),ctx.stroke(),ctx.moveTo(-.75*n,-2.75*n),ctx.lineTo(-1.15*n,-3.15*n),ctx.stroke(),ctx.moveTo(.75*n,-2.75*n),ctx.lineTo(1.15*n,-3.15*n),ctx.stroke(),ctx.fillStyle=o,ctx.globalAlpha=.5,ctx.fill(),ctx.restore()}var disscore=!0;a1=["","Infect!","Caution!","Warning!","Danger!","Immune!","Wait!","Cancer!","Death!","Reproduce!","Survivor!","Green!","Blue!","Purple!","Mutate!","Mutate!"],a2=["","Use your mouse to guide your viruses to infect the red cells.<br>Smaller red cells are easier to infect.","Unhealthy green anti-viral medicine has spawned!<br>If your viruses survive, they develop green resistance.","Crippling blue anti-viral medicine has spawned!<br>If your viruses survive, they develop blue resistance.","Deadly purple anti-viral medicine has spawned!<br>If your viruses survive, they develop purple resistance.","Red cells with black membranes are now immune to your viruses.<br>Infect a red cell with another player to mutate.","Infected cells are being irradiated, killing the viruses trapped inside.<br>Wait until radiation ends before infecting.","Cancer cells have spawned!<br>Find and infect the brown cells to stop the host from dying.","The host is near death!<br>Destroy the brown cancer cells to stop the host from dying.","Your viruses have infected a red cell!<br>The cell will release your trapped viruses plus one new one.","You saved the host by defeating the cancer! 🎗","Exposure to green medicine has strengthened your viruses.<br>Your score has increased.","Exposure to blue medicine has strengthened your viruses.<br>Your score has increased.","Exposure to purple medicine has strengthened your viruses.<br>Your score has increased.","Many red cells are immune to your viruses.<br>Infect a red cell with another player to mutate.","Your viruses have exchanged genes! Fewer red cells are immune."],a3=[!0,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],document.onmousemove=function(e){mousex=e.clientX,mousey=e.clientY},window.onresize=function(e){WIDTH=window.innerWidth,HEIGHT=window.innerHeight,document.getElementById("ctx").width=WIDTH,document.getElementById("ctx").height=HEIGHT};