const debug_scoreboard=false;const debug_performance=true;var incircle=0;var inmed=0;function play_powerup(){document.getElementById("audiotag1").play()}function play_powerdown(){document.getElementById("audiotag2").play()}function play_damage(){document.getElementById("audiotag3").play()}function play_death(){document.getElementById("audiotag4").play()}function play_med(){document.getElementById("audiotag5").play()}function play_slurp(){document.getElementById("audiotag6").play()}function play_host_death(){document.getElementById("audiotag8").play()}function play_host_revival(){document.getElementById("audiotag9").play()}function play_cancer_spawn(){document.getElementById("audiotag10").play()}function play_click(){document.getElementById("audiotag11").play()}function play_cancer(){if(intensity<1){document.getElementById("audiotag7").volume=intensity}else{document.getElementById("audiotag7").volume=0}document.getElementById("audiotag7").play()}function stop_sounds(){document.getElementById("audiotag1").pause();document.getElementById("audiotag2").pause();document.getElementById("audiotag3").pause();document.getElementById("audiotag4").pause();document.getElementById("audiotag5").pause();document.getElementById("audiotag6").pause();document.getElementById("audiotag7").pause();document.getElementById("audiotag10").pause()}stop_sounds();function tutor(){tutorsteps=[false,false,false];signDiv.style.display="none";deathDiv.style.display="none";gameDiv.style.display="none";wants=true;incircle=0;setTimeout(play,10)}function play_tip(){if(disscore){document.getElementById("audiotag12").play()}}function hex_rv(e){if(e.charAt(0)=="#"&&e.length==7){var t="#";for(var l=1;l<7;l++){var i=parseInt(e.charAt(l),16);if(0<=i&&i<16){i=15-i;t=t+i.toString(16).toUpperCase()}else{console.trace("hex_rv: invalid hex color digit d="+i);return"#000000"}}return t}else{console.trace("hex_rv: invalid input hex="+e);return"#000000"}}function isInside(e,t,l,i,s){var a=e<i?i-e:e-i;if(a>=l){return false}var r=t<s?s-t:t-s;if(r>=l){return false}return a*a+r*r<l*l}function getDistance(e,t,l,i){return Math.sqrt(Math.pow(e-l,2)+Math.pow(t-i,2))}function gettime(){var e=new Date;return e.getTime()}var WIDTH=window.innerWidth;var HEIGHT=window.innerHeight;var cell_immune=[0,20,40,80,1e9,1e9];document.getElementById("ctx").width=WIDTH;document.getElementById("ctx").height=HEIGHT;var mini=document.getElementById("minimap").getContext("2d");var socket=null;var entermed=0;var exitmed=0;var stage=4;var tutorsteps=[false,false,false];var startti=0;var wants=false;var endti=0;var sizeX=5e3;var sizeY=5e3;var numcells=0;var finalscore=0;var ino=true;var numvirus=0;var iradtimer=0;var x=0;var y=0;var intensity=0;var mousex=0;var mousey=0;var selfx=0;var selfy=0;var reset=false;var medicine=[];var scores=[];var names=[];var resettimer=100;var numcancer=0;var cancerwaslast=true;var alerts=["Enter!","",""];var tooltips=["Press enter â†µ to cycle through display tips","",""];var ontip=0;var viewtips=["This is how many viruses you have","This is how many cancer cells there are","This is how many red cells you have infected","This is your resistance to green medicine","This is your resistance to blue medicine","This is your resistance to purple medicine","This is your score",""];if(Cookies.get("topscore")!==undefined){if(Cookies.get("topscore")>0){document.getElementById("welcome").style.display="inline-block";document.getElementById("cookiescore").innerHTML=Number(Cookies.get("topscore")).toLocaleString()}}const signDiv=document.getElementById("signDiv");const deathDiv=document.getElementById("deathDiv");const signDivUsername=document.getElementById("signDiv-username");var handle=Cookies.get("name");if(handle===undefined){handle=""}signDivUsername.value=handle;var signDivSignIn=document.getElementById("signDiv-signIn");function addtooltip(e){if(!a3[e]){a3[e]=true;alerts.unshift(a1[e]);tooltips.unshift(a2[e]);play_tip()}}signDivSignIn.onclick=function(){playp()};function playp(){disscore=false;ontip=7;play()}function play(){var e=String(signDivUsername.value);Cookies.set("name",e);var t=document.getElementById("serverSelect");var l=t.options[t.selectedIndex].value;document.getElementById("minimap").style.display="block";if(socket){socket.disconnect(true);socket=null}socket=io.connect(l);if(socket===undefined){return}socket.emit("signIn",signDivUsername.value);socket.on("signInResponse",function(e,t){if(e){console.log(`signInResponse(${e},${t})`);selfId=t;signDiv.style.display="none";deathDiv.style.display="none";gameDiv.style.display="inline-block";if(!wants){ino=true}else{ino=false;selfx=500;selfy=500}setTimeout(main,0)}});socket.on("init",function(e){let t=e.player.length;for(let l=0;l<t;l++){new Player(e.player[l])}t=e.cell.length;for(i=0;i<t;i++){new Cell(e.cell[i])}});socket.on("update",function(e){let t=e.player.length;for(let l=0;l<t;l++){let t=e.player[l];let i=Player.list[t.id];if(i){i.x=t.x;i.y=t.y;i.dmg=t.immunity;if(i.id==selfId&&t.infects!==i.infects){counterp=counter+50}i.infects=t.infects;i.avg=t.avg}}t=e.cell.length;for(i=0;i<t;i++){let t=e.cell[i];let l=Cell.list[t.id];if(l){l.x=t.x;l.y=t.y;l.create=t.create;l.cells=t.cells;l.size=t.size}}});socket.on("remove",function(e){let t=e.player.length;for(let l=0;l<t;l++){delete Player.list[e.player[l]]}t=e.cell.length;for(i=0;i<t;i++){let t=Cell.list[e.cell[i]];if(t!==undefined){if(!t.type){t.prephase=true}else{t.phase=true}}else{delete Cell.list[self.id]}}});socket.on("medicine",function(e){medicine=e});socket.on("scores",function(e){scorelist=e});socket.on("co",function(e){if(e){addtooltip(15)}});socket.on("resetall",function(e){reset=true});socket.on("stage",function(e){stage=e;if(counter>20){switch(stage){case 1:play_powerup();break;case 2:play_damage();break;case 3:play_powerdown();break}}});socket.on("death",function(){stop_sounds();document.getElementById("minimap").style.display="none";finalscore=Math.round(Player.list[selfId].infects*((1-Player.list[selfId].dmg[0])*100*((1-Player.list[selfId].dmg[1])*100))*((1-Player.list[selfId].dmg[2])*100));document.getElementById("scored").innerHTML="Final score: "+finalscore;var e=Cookies.get("topscore");console.log("get topscore = "+e);var t=document.getElementById("twitterBrag");if(isNaN(e)||e<finalscore){Cookies.set("topscore",finalscore);console.log("set topscore = "+Cookies.get("topscore"));document.getElementById("best").style.display="inline-block";if(t){t.href=`https://twitter.com/share?url=http://glork.io&via=GlorkIOGame&text=New%20personal%20best!%20I%20scored%20${finalscore}%20points%20in%20http://glork.io.%20Can%20you%20do%20better?%20#FightFlu%20#PlayFlu`}}else{document.getElementById("best").style.display="none";if(t){t.href=`https://twitter.com/share?url=http://glork.io&via=GlorkIOGame&text=I%20scored%20${finalscore}%20points%20in%20http://glork.io.%20Can%20you%20do%20better?%20#FightFlu%20#PlayFlu`}}deathDiv.style.display="inline-block";gameDiv.style.display="inline-block"});document.onkeydown=function(e){if(!isNaN(e.keyCode)){switch(e.keyCode){case 13:addtooltip(1);play_click();ontip++;if(ontip===8){ontip=0}break;case 32:tutorsteps[0]=true;selfx=Player.list[selfId].x[0];selfy=Player.list[selfId].y[0];break;case 84:disscore=!disscore;if(!disscore){ontip=7}break;default:socket.emit("debugKey",e.keyCode,selfx,selfy)}}}}var scorelist=[];var radstop=0;function drawminimap(){mini.save();mini.clearRect(0,0,150,150);mini.restore()}var ctx=document.getElementById("ctx").getContext("2d");ctx.font="30px Arial";var Player=function(e){var t={};t.id=e.id;t.x=e.x;t.y=e.y;t.dmg=e.immunity;t.avg=e.avg;t.color=String(e.color);t.infects=0;t.introuble=false;t.name=e.name;console.log("Player(initPack) id:"+e.id+" color:"+e.color+" name:"+e.name);t.draw=function(){if(!t.id){return}if(ino){selfx=Player.list[selfId].x[0];selfy=Player.list[selfId].y[0];ino=false}var e=t.x[0]-selfx+WIDTH/2;var l=t.y[0]-selfy+HEIGHT/2;ctx.beginPath();ctx.fillStyle=t.color;if(t.id===selfId){if(wants){if(incircle<t.x.length){if(t.infects===0){ctx.globalAlpha=1;ctx.font="bold 40px Arial";ctx.fillStyle="black";ctx.fillText("These are your viruses",e-200,l-50)}}else{ctx.globalAlpha=0}ctx.globalAlpha=1}var e=mousex;var l=mousey;ctx.beginPath();ctx.arc(e,l,500,0,2*Math.PI);ctx.stroke()}for(var i in t.x){numvirus++;ctx.fillStyle=t.color;mini.fillStyle=t.color;mini.fillRect(t.x[i]/sizeX*150-2,t.y[i]/sizeY*150-2,4,4);var e=t.x[i]-selfx+WIDTH/2;var l=t.y[i]-selfy+HEIGHT/2;if(medicine[0]!==undefined){if(getDistance(t.x[i],t.y[i],medicine[0],medicine[1])<medicine[2]&&Player.list[selfId].dmg[medicine[4]]>.001){t.introuble=true}else{t.introuble=false}}else{t.introuble=false}if(t.introuble){if(t.id===selfId){drawFlu(e,l,8,timer,hex_rv(t.color));inmed++;play_med()}else{drawFlu(e,l,8,timer,t.color)}}else{if(stage===1&&counter%16<8){drawFlu(e,l,8,timer,hex_rv(t.color))}else{drawFlu(e,l,8,timer,t.color)}document.getElementById("audiotag5").pause()}ctx.fillStyle="black"}};Player.list[t.id]=t;return t};Player.list={};function drawMed(){if(medicine[1]!==undefined){ctx.beginPath();mini.beginPath();if(medicine[4]===0){addtooltip(2);ctx.fillStyle="#39FF14";mini.fillStyle="#39FF14"}else if(medicine[4]===1){addtooltip(3);ctx.fillStyle="#00CCFF";mini.fillStyle="#00CCFF"}else if(medicine[4]===2){addtooltip(4);ctx.fillStyle="#FF1DCE";mini.fillStyle="#FF1DCE"}var e=medicine[0]-selfx+WIDTH/2;var t=medicine[1]-selfy+HEIGHT/2;ctx.globalAlpha=medicine[3];mini.globalAlpha=medicine[3];ctx.arc(e,t,medicine[2],0,2*Math.PI);mini.arc(medicine[0]/sizeX*150,medicine[1]/sizeY*150,medicine[2]/sizeX*150,0,2*Math.PI);ctx.fill();mini.fill();ctx.globalAlpha=1;mini.globalAlpha=1;mini.fillStyle="black"}}var Cell=function(e){var t={};t.id=e.id;t.x=e.x;t.y=e.y;t.size=e.size;t.create=e.create;t.type=e.type;t.cells=e.cells;t.cancer=e.cancer;t.eat=null;t.mag=null;t.phase=false;t.phaser=1;t.prephase=false;t.prephaser=2;t.lastcells=0;t.draw=function(){let e=t.cells;numcells++;if(t.lastcells!==t.cells){t.lastcells=t.cells;if(!t.type){play_slurp()}}if(t.prephase){t.prephaser-=.1;if(!t.type){t.size=20*t.cells+25}if(t.prephaser<.1){t.phase=true}}if(t.cancer){numcancer++}var l=t.x-selfx+WIDTH/2;var i=t.y-selfy+HEIGHT/2;if(t.type){if(t.phase){t.phaser-=.1;if(t.phaser<=.1){delete Cell.list[t.id];return}}ctx.globalAlpha=t.phaser;if(t.cells>0&&stage===1&&counter%16<8){ctx.fillStyle="#ffc0cb";if(t.cancer){drawCell(l,i,t.size,"#00134C","#3366ff")}else{drawCell(l,i,t.size,"#003F34","#009982")}while(t.cells>0){drawFlu(l+t.size/2-t.cells*50+25,i+t.size/2-t.cells*50+25,10,timer,"green",0);t.cells-=1}t.cells=e}else{ctx.fillStyle="#003f34";if(t.cancer){drawCell(l,i,t.size,"#FFECB3","#CC9900");mini.beginPath();mini.fillStyle="#CC9900";mini.arc(t.x/sizeX*150,t.y/sizeY*150,t.size/sizeX*300,0,2*Math.PI);mini.fill();play_cancer()}else{var s=Player.list[selfId];if(s===undefined||s.avg<cell_immune[Math.round(t.size/50)]||t.size>=200||t.cells>0){drawCell(l,i,t.size,"pink","#FF667D")}else{if(t.size===50){addtooltip(5)}else{addtooltip(14)}drawCell(l,i,t.size,"black","#FF667D");ctx.beginPath();ctx.arc(l,i,t.size,0,2*Math.PI);ctx.stroke();ctx.lineWidth=2}}while(t.cells>0){drawFlu(l+t.size/2-t.cells*50+25,i+t.size/2-t.cells*50+25,10,timer,"green",0);t.cells-=1}t.cells=e}}else{if(t.phase){t.phaser-=.1;if(t.phaser<=.1){delete Cell.list[t.id];return}}ctx.globalAlpha=t.phaser;drawCell(l,i,t.size*.8,"gray","white");while(t.cells>0){drawFlu(l+t.size/2-t.cells*24+5,i+t.size/2-t.cells*24+5,10,timer,"green",0);t.cells-=1}t.cells=e}ctx.globalAlpha=1};Cell.list[t.id]=t;return t};Cell.list={};var selfId=null;var counterp=1e8;function updatexy(){if(getDistance(WIDTH/2+8,HEIGHT/2+8,mousex,mousey)<10){socket.emit("mouse",selfx,selfy)}else{var e=mousex+selfx-WIDTH/2;var t=mousey+selfy-HEIGHT/2;socket.emit("mouse",e,t)}}var timer=0;var pulser=0;var counter=0;var perstats=[0,0,0,0];const trials=1e3;var down=false;function updatePulser(){if(pulser>5){down=true}else if(pulser<-5){pulser+=.5;down=false}if(down){pulser-=.5}else{pulser+=.5}}function main(){var e=gettime();mini.clearRect(0,0,150,150);drawminimap();if(counter===counterp){play_death()}ctx.clearRect(0,0,WIDTH,HEIGHT);inmed=0;if(!selfId){return}updatePulser();if(Player.list[selfId]!=undefined){selfx=(mousex-WIDTH/2)/20+selfx;selfy=(mousey-HEIGHT/2)/20+selfy;if(selfx<WIDTH/2){selfx=WIDTH/2}else if(selfx>sizeX-WIDTH/2){selfx=sizeX-WIDTH/2}if(selfy<HEIGHT/2){selfy=HEIGHT/2}else if(selfy>sizeY-HEIGHT/2){selfy=sizeY-HEIGHT/2}}ctx.fillStyle="white";ctx.fillRect(x,y,sizeX,sizeY);ctx.globalAlpha=intensity;ctx.fillStyle="black";ctx.fillRect(0,0,WIDTH,HEIGHT);ctx.globalAlpha=1;drawMap();drawMed();updatexy();incircle=0;var t=Player.list[selfId];if(t!==undefined){var l=t.x.length;for(var i=0;i<l;i++){if(getDistance(selfx+(mousex-WIDTH/2),selfy+(mousey-HEIGHT/2),t.x[i],t.y[i])<500){incircle++}else if(wants){ctx.globalAlpha=.4;ctx.fillStyle=hex_rv(t.color);ctx.beginPath();ctx.arc(t.x[i]-selfx+WIDTH/2,t.y[i]-selfy+HEIGHT/2,40,0,2*Math.PI);ctx.stroke();ctx.fill()}}}ctx.globalAlpha=1;for(var i in Player.list){Player.list[i].draw()}for(var i in Cell.list){Cell.list[i].draw()}if(t!==undefined){drawScoreboard()}if(reset){document.getElementById("audiotag8").pause();play_host_revival();ctx.fillStyle="white";ctx.globalAlpha=resettimer/100;ctx.fillRect(0,0,WIDTH,HEIGHT);ctx.fillStyle="black";ctx.font="160px ubuntu";ctx.fillText("REVIVED!",WIDTH/2-300,HEIGHT/2-20);resettimer-=1.5;ctx.globalAlpha=1;if(resettimer<=0){reset=false;resettimer=100}}if(t!=undefined){ctx.beginPath();ctx.arc(mousex,mousey,500,0,2*Math.PI);ctx.stroke();if(wants){ctx.font="bold 40px Arial";ctx.fillStyle="black";if(!tutorsteps[0]){ctx.fillText("Press SPACE to find your viruses",mousex-300,mousey-50)}else{if(incircle<l){ctx.fillText("Keep your viruses inside your mouse circle",mousex-400,mousey-50)}else if(inmed>0){ctx.fillText("Escape the medicine before it kills you!",mousex-300,mousey-50);if(entermed===0){entermed=counter;exitmed=0}}else if(inmed===0&&(entermed>0||exitmed>0)){if(exitmed===0){exitmed=counter+90;entermed=0}if(counter<exitmed){ctx.fillText("What doesn't kill you makes you stronger!",mousex-400,mousey-50)}}else if(t.infects===0){ctx.fillText("Attack a small red cell until it fills up",mousex-350,mousey-50)}else if(t.infects>0&&counter<300){ctx.fillText("Congratulations! You replicated your virus.",mousex-400,mousey-50)}}}}intensity=numcancer/(numvirus+1);intensity=Math.pow(intensity,2);timer++;counter++;numcancer=0;numcells=0;numvirus=0;var s=gettime()-e;var a=1e3/24-s;if(a<=0){a=0}if(debug_performance){perstats[0]+=s;perstats[1]+=s*s;if(s>perstats[2]){perstats[2]=s}if(a<=0){perstats[3]++}if(counter%trials===0){var r=perstats[0]/trials;console.log("performance,"+Math.floor(counter/trials)+","+trials+","+Math.round(100*r)/100+","+Math.round(100*Math.sqrt(perstats[1]/trials-r*r))/100+","+Math.round(1e4*perstats[3]/trials)/1e4+","+perstats[2]);perstats=[0,0,0,0]}}setTimeout(main,a)}function drawGrid(e,t,l,i,s,a,r,n){ctx.save();ctx.globalAlpha=.5;ctx.translate(e,t);ctx.strokeStyle=a;ctx.lineWidth=2;ctx.beginPath();for(var o=0;o<l||o<i;o+=s){ctx.moveTo(0,o);ctx.lineTo(l,o);ctx.moveTo(o+r%s,0);ctx.lineTo(o+r%s,i)}ctx.closePath();ctx.stroke();ctx.restore()}var drawMap=function(){var e=WIDTH/2-selfx;var t=HEIGHT/2-selfy;if(counter<radstop||stage===4){ctx.fillStyle="white";drawGrid(e,t,sizeX,sizeY,50,"#BFBFBF",0,0)}else if(stage===1){ctx.fillStyle="#070707";addtooltip(6);ctx.fillRect(e,t,sizeX,sizeY);drawGrid(e,t,sizeX,sizeY,50,"#404040",0,0)}else{ctx.fillStyle="white";drawGrid(e,t,sizeX,sizeY,50,"#BFBFBF",0,0)}};function drawBox(e,t,l,i){ctx.fillStyle="#FFFF00";ctx.globalAlpha=.5;ctx.beginPath();ctx.arc(e,t,i,.5*Math.PI,-.5*Math.PI);ctx.lineTo(e+l,t-i);ctx.arc(e+l,t,i,-.5*Math.PI,.5*Math.PI);ctx.lineTo(e,t+i);ctx.stroke();ctx.fill();ctx.globalAlpha=1}var widthsofboxes=[690,750,850,500,500,500,400,0];var heightsofboxes=[50,50,50,20,20,20,50,0];var drawScoreboard=function(){if(Player.list[selfId].dmg[0]<.99){addtooltip(11)}if(Player.list[selfId].dmg[1]<.99){addtooltip(12)}if(Player.list[selfId].dmg[2]<.99){addtooltip(13)}if(ontip<3||ontip===6){ctx.font="40px Crushed";var e=30}else{ctx.font="20px Crushed";var e=15}for(var t=0;t<ontip;t++){e+=heightsofboxes[t]}if(ontip!==7){drawBox(0,e,widthsofboxes[ontip]+50,heightsofboxes[ontip]/2)}ctx.fillStyle="black";if(ontip<3||ontip>=6){if(ontip!==7){ctx.fillText(viewtips[ontip]+" â†µ",150,e+10)}else{ctx.fillText("",150,e+10)}}else{ctx.fillText(viewtips[ontip]+" ("+Math.round(100*(1-Player.list[selfId].dmg[ontip-3]))+"%) "+"â†µ",150,e+5)}var l="<table style='font-size:30px;text-align:left'>";for(var t=0;t<3;t++){l+="<tr><td><b>"+alerts[t]+"</b></td><td>"+tooltips[t]+"</td><td></tr>"}l+="</table>";if(disscore){document.getElementById("vvv").innerHTML=l}else{document.getElementById("vvv").innerHTML=""}ctx.fillStyle="black";ctx.font="30px Crushed";var i=30;var s=ctx.measureText("Scoreboard").width;ctx.font="24px Crushed";var a=scorelist.length;for(var t=0;t<a;t++){var r=Player.list[scorelist[t]];if(r!==undefined){var e=ctx.measureText(r.name.substr(0,15)).width;if(e>s){s=e}}}if(debug_scoreboard){const l=["GS25",":D","hector","([])","Fabien","x","your mother","Canser","HiDead","treplaysgames21","All Might"];var n=l.length;n=8;for(var t=0;t<n;t++){var e=ctx.measureText(l[t].substr(0,15)).width;if(e>s){s=e}}}var o=24+48+s+100;var c=WIDTH-o;var d=20+i;ctx.font="30px Crushed";ctx.fillText("Scoreboard",c,d);ctx.font="24px Crushed";for(var t=0;t<a;t++){var r=Player.list[scorelist[t]];if(r!==undefined){var f=Math.round(r.infects*((1-r.dmg[0])*100*((1-r.dmg[1])*100))*((1-r.dmg[2])*100));if(f>1e6){f=Math.floor(f/1e6)+"M"}else if(f>1e3){f=Math.floor(f/1e3)+"K"}var e=ctx.measureText(f+"").width+40;var u=r.name.substr(0,15);d+=i;ctx.fillText(t+1+".",c,d,24);ctx.fillText(u,c+24+48,d,s);ctx.fillText(f,WIDTH-e,d);drawFlu(c+48,d-8,8,0,r.color)}}if(debug_scoreboard){const l=[214225715,124883136,1302682,438719,327153,2267,313,309,276,80,19,0];const r=["#00FF00","#FF00FF","#00FFFF","#FFFF00","#FF6600","#0000FF","#FF0000","#000000","#FFFFFF","#8800FF","#FF0088","#0088FF"];for(var t=0;t<n;t++){var f=l[t];if(f>1e6){f=Math.floor(f/1e6)+"M"}else if(f>1e3){f=Math.floor(f/1e3)+"K"}var e=ctx.measureText(f+"").width+40;var u=debug_names[t].substr(0,15);d+=i;ctx.fillText(a+t+1+".",c,d,24);ctx.fillText(u,c+24+48,d,s);ctx.fillText(f,WIDTH-e,d);drawFlu(c+48,d-8,8,0,r[t])}}ctx.globalAlpha=.5;ctx.fillStyle="black";ctx.globalAlpha=1;drawFlu(20,30,10,timer,Player.list[selfId].color);drawCell(20,130,14,"pink","#FF667D");drawCell(20,80,14,"#FFECB3","#CC9900");ctx.font="40px Crushed";ctx.fillText(Math.round(Player.list[selfId].infects),40,140);if(Math.round(Player.list[selfId].infects)===1){addtooltip(9)}ctx.fillText(Math.round(Player.list[selfId].infects*((1-Player.list[selfId].dmg[0])*100*((1-Player.list[selfId].dmg[1])*100))*((1-Player.list[selfId].dmg[2])*100)),0,250);ctx.font="30px Crushed";ctx.font="40px Crushed";if(numcancer!==0&&cancerwaslast){play_cancer_spawn();cancerwaslast=false}if(!cancerwaslast&&numcancer===0){addtooltip(10)}else if(numcancer===0){cancerwaslast=true}if(numcancer>0){addtooltip(7)}var m=Player.list[selfId].x;ctx.fillText(m.length,40,40);ctx.fillText(numcancer,40,90);ctx.strokeStyle="#39FF14";ctx.strokeRect(0,155,100,20);ctx.strokeStyle="#00CCFF";ctx.strokeRect(0,175,100,20);ctx.strokeStyle="#FF1DCE";ctx.strokeRect(0,195,100,20);ctx.globalAlpha=.5;ctx.fillStyle="#39FF14";ctx.fillRect(0,155,100*(1-Player.list[selfId].dmg[0]),20);ctx.fillStyle="#00CCFF";ctx.fillRect(0,175,100*(1-Player.list[selfId].dmg[1]),20);ctx.fillStyle="#FF1DCE";ctx.fillRect(0,195,100*(1-Player.list[selfId].dmg[2]),20);ctx.globalAlpha=1;ctx.strokeStyle="black";ctx.fillStyle="gray";if(intensity>.5){addtooltip(8);if(intensity>1){document.getElementById("audiotag7").pause();play_host_death()}}};function drawCell(e,t,l,i,s){ctx.save();ctx.translate(e,t);ctx.beginPath();ctx.arc(0,0,l,0,2*Math.PI);ctx.fillStyle=i;ctx.fill();ctx.beginPath();ctx.arc(0,0,l*(.9+pulser/200),0,2*Math.PI);ctx.fillStyle=s;ctx.fill();ctx.restore()}function drawFlu(e,t,l,i,s,a){var r=a===undefined?.5:a;ctx.save();ctx.translate(e,t);ctx.fillStyle=s;ctx.lineWidth=3;ctx.rotate(i*(Math.PI/180));ctx.lineCap="round";ctx.beginPath();ctx.arc(0,0,l,0,2*Math.PI);ctx.globalAlpha=r;ctx.fill();ctx.globalAlpha=1;ctx.moveTo(0,-1*l);ctx.lineTo(0,-1*(l*1.5));ctx.moveTo(0,1*l);ctx.lineTo(0,1*(l*1.5));ctx.moveTo(-1*l,0);ctx.lineTo(-1*(l*1.5),0);ctx.moveTo(1*l,0);ctx.lineTo(1*(l*1.5),0);ctx.rotate(45*(Math.PI/180));ctx.moveTo(0,-1*l);ctx.lineTo(0,-1*(l*1.5));ctx.moveTo(0,1*l);ctx.lineTo(0,1*(l*1.5));ctx.moveTo(-1*l,0);ctx.lineTo(-1*(l*1.5),0);ctx.moveTo(1*l,0);ctx.lineTo(1*(l*1.5),0);ctx.stroke();ctx.restore()}var disscore=true;var a1=["","Infect!","Caution!","Warning!","Danger!","Immune!","Wait!","Cancer!","Death!","Reproduce!","Survivor!","Green!","Blue!","Purple!","Mutate!","Mutate!"];var a2=["","Use your mouse to guide your viruses to infect the red cells.<br>Smaller red cells are easier to infect.","Unhealthy green anti-viral medicine has spawned!<br>If your viruses survive, they develop green resistance.","Crippling blue anti-viral medicine has spawned!<br>If your viruses survive, they develop blue resistance.","Deadly purple anti-viral medicine has spawned!<br>If your viruses survive, they develop purple resistance.","Red cells with black membranes are now immune to your viruses.<br>Infect a red cell with another player to mutate.","Infected cells are being irradiated, killing the viruses trapped inside.<br>Wait until radiation ends before infecting.","Cancer cells have spawned!<br>Find and infect the brown cells to stop the host from dying.","The host is near death!<br>Destroy the brown cancer cells to stop the host from dying.","Your viruses have infected a red cell!<br>The cell will release your trapped viruses plus one new one.","You saved the host by defeating the cancer! ðŸŽ—","Exposure to green medicine has strengthened your viruses.<br>Your score has increased.","Exposure to blue medicine has strengthened your viruses.<br>Your score has increased.","Exposure to purple medicine has strengthened your viruses.<br>Your score has increased.","Many red cells are immune to your viruses.<br>Infect a red cell with another player to mutate.","Your viruses have exchanged genes! Fewer red cells are immune."];var a3=[true,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false];document.onmousemove=function(e){mousex=e.clientX;mousey=e.clientY};window.onresize=function(e){WIDTH=window.innerWidth;HEIGHT=window.innerHeight;document.getElementById("ctx").width=WIDTH;document.getElementById("ctx").height=HEIGHT};